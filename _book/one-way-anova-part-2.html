<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 One-way ANOVA Part 2 | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 One-way ANOVA Part 2 | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 One-way ANOVA Part 2 | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="repeated-measures-anova-part-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#validation-of-power-in-one-way-anova"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#two-conditions"><i class="fa fa-check"></i><b>2.2</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#validation-of-power-in-one-way-anova-with-brysbaert-example"><i class="fa fa-check"></i><b>3.1</b> Validation of Power in One-Way ANOVA with Brysbaert example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Three conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2</b> Power for simple effects</a></li>
<li class="chapter" data-level="3.3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#one-way-anova-part-3"><i class="fa fa-check"></i><b>3.3</b> One-way ANOVA Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication"><i class="fa fa-check"></i><b>3.4</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.5" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#variation-1"><i class="fa fa-check"></i><b>3.5</b> Variation 1</a></li>
<li class="chapter" data-level="3.6" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>3.6</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.7" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#variation-2"><i class="fa fa-check"></i><b>3.7</b> Variation 2</a></li>
<li class="chapter" data-level="3.8" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>3.8</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures-ANOVA Part 1</a><ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>5.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="5.2" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>5.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html"><i class="fa fa-check"></i><b>6</b> Repeated Measures-ANOVA Part 3</a><ul>
<li class="chapter" data-level="6.1" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>6.1</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="6.2" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>6.2</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-way-anova-part-2" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> One-way ANOVA Part 2</h1>
<div id="validation-of-power-in-one-way-anova-with-brysbaert-example" class="section level2">
<h2><span class="header-section-number">3.1</span> Validation of Power in One-Way ANOVA with Brysbaert example</h2>
<div id="three-conditions" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Three conditions</h3>
<p>Imagine we aim to design a study to test the hypothesis that giving people a pet to take care of will increase their life satisfaction. We have a control condition, a ‘cat’ pet condition, and a ‘dog’ pet condition. We can simulate a One-Way ANOVA with a specified alpha, sample size, and effect size, on see the statistical power we would have for the ANOVA and the follow-up comparisons. We expect all pets to increase life-satisfaction compared to the control condition. Obviously, we also expect the people who are in the ‘dog’ pet condition to have even greater life-satisfaction than people in the ‘cat’ pet condition. Based on work by Pavot and Diener (1993) we believe that we can expect responses on the life-satifaction scale to have a mean of approximately 24 in our population, with a standard deviation of 6.4. We expect having a pet increases life satisfaction with approximately 2.2 scale points for participants who get a cat, and 2.6 scale points for participants who get a dog. We initially consider collecting data from 150 participants in total, with 50 participants in each condition. But before we proceed with the data collection, we examine the statistical power our design would have to detect the differences we predict.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">string &lt;-<span class="st"> &quot;3b&quot;</span></a>
<a class="sourceLine" id="cb33-2" title="2">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co"># We are thinking of running 50 peope in each condition</span></a>
<a class="sourceLine" id="cb33-4" title="4">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">24</span>, <span class="fl">26.2</span>, <span class="fl">26.6</span>)</a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co"># In this case, control, cat, dog. </span></a>
<a class="sourceLine" id="cb33-7" title="7">sd &lt;-<span class="st"> </span><span class="fl">6.4</span></a>
<a class="sourceLine" id="cb33-8" title="8">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;cat&quot;</span>, <span class="st">&quot;dog&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb33-10" title="10">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb33-11" title="11">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb33-12" title="12">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb33-13" title="13">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb33-14" title="14">                   <span class="dt">labelnames =</span> labelnames)</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co"># You should think carefully about how to justify your alpha level.</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co"># We will give some examples later, but for now, use 0.05.</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power effect_size
## anova_condition    48     0.04444
## 
## Power and Effect sizes for contrasts
##                                   power effect_size
## p_condition_control_condition_cat    39     0.34189
## p_condition_control_condition_dog    47     0.40463
## p_condition_cat_condition_dog         5     0.06564</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">#should yield</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">#0.3983064</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">#0.5205162</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">#0.06104044</span></a></code></pre></div>
<p>The result shows that you would have quite low power with 50 participants, both for the overall ANOVA (just around 50% power), as for the follow up comparisons (approximately 40% power for the control vs cat condition, around 50% for the control vs dogs condition, and a really low power (around 6%, just above the Type 1 error rate of 5%) for the expected difference between cats and dogs.</p>
</div>
</div>
<div id="power-for-simple-effects" class="section level2">
<h2><span class="header-section-number">3.2</span> Power for simple effects</h2>
<p>We are typically not just interested in the ANOVA, but also in follow up comparisons. In this case, we would perform a <em>t</em>-test comparing the control condition against the cat and dog condition, and we would compare the cat and dog conditions against each other, in independent <em>t</em>-tests.</p>
<p>For our example, Cohen’s d (the standardized mean difference) is 2.2/6.4, or d = 0.34375 for the difference between the control condition and cats, 2.6/6.4 of d = 0.40625 for the difference between the control condition and dogs, and 0.4/6.4 or d = 0.0625 for the difference between cats and dogs as pets.</p>
<p>We can easily compute the expected power for these simple comparisons using the pwr package.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">2.2</span><span class="op">/</span><span class="fl">6.4</span>,</a>
<a class="sourceLine" id="cb37-2" title="2">           <span class="dt">n =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb37-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb37-4" title="4">           <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb37-5" title="5">           <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.3983064</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">2.6</span><span class="op">/</span><span class="fl">6.4</span>,</a>
<a class="sourceLine" id="cb39-2" title="2">           <span class="dt">n =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb39-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb39-4" title="4">           <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb39-5" title="5">           <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.5205162</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">0.4</span><span class="op">/</span><span class="fl">6.4</span>,</a>
<a class="sourceLine" id="cb41-2" title="2">           <span class="dt">n =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb41-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb41-4" title="4">           <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb41-5" title="5">           <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.06104044</code></pre>
<p>This analysis tells us that running the study with 50 participants in each condition is more likely to <em>not</em> yield a significant test result, even if our expected pattern of differences is true, than that we will observe a <em>p</em>-value smaller than our alpha level. This is not optimal.</p>
<p>Let’s mathematically explore which pattern of means we would need to expect to habe 90% power for the ANOVA with 50 participants in each group. We can use the pwr package in R to compute a sensitivity analysis that tells us the effect size, in Cohen’s f, that we are able to detect with 3 groups and 50 partiicpants in each group, in order to achive 90% power with an alpha level of 5%.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">K &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb43-2" title="2">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb43-3" title="3">sd &lt;-<span class="st"> </span><span class="fl">6.4</span></a>
<a class="sourceLine" id="cb43-4" title="4">r &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co">#Calculate f when running simulation</span></a>
<a class="sourceLine" id="cb43-6" title="6">f &lt;-<span class="st"> </span><span class="kw">pwr.anova.test</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb43-7" title="7">                    <span class="dt">k =</span> K,</a>
<a class="sourceLine" id="cb43-8" title="8">                    <span class="dt">power =</span> <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb43-9" title="9">                    <span class="dt">sig.level =</span> alpha_level)<span class="op">$</span>f</a>
<a class="sourceLine" id="cb43-10" title="10">f</a></code></pre></div>
<pre><code>## [1] 0.2934417</code></pre>
<p>This sensitivity analysis shows we have 90% power in our planned design to detect effects of Cohen’s f of 0.2934417. Benchmarks by Cohen (1988) for small, medium, and large Cohen’s f values are 0.1, 0.25, and 0.4, which correspond to eta-squared values of small (.0099), medium (.0588), and large (.1379), in line with d = .2, .5, or .8. So, at least based on these benchmarks, we have 90% power to detect effects that are somewhat sizeable.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">f2 &lt;-<span class="st"> </span>f<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-2" title="2">ES &lt;-<span class="st"> </span>f2<span class="op">/</span>(f2<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb45-3" title="3">ES</a></code></pre></div>
<pre><code>## [1] 0.07928127</code></pre>
<p>Expressed in eta-squared, we can detect values of eta-squared = 0.0793 or larger.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)</a>
<a class="sourceLine" id="cb47-2" title="2">mu &lt;-<span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>sd</a>
<a class="sourceLine" id="cb47-3" title="3">mu</a></code></pre></div>
<pre><code>## [1] -2.300104  0.000000  2.300104</code></pre>
<p>We can compute a pattern of means, given a standard deviation of 6.4, that would give us an effect size of f = 0.2934, or eta-squared of 0.0793. We should be able to accomplish this is the means are -2.300104, 0.000000, and 2.300104. We can use these values to confirm the ANOVA has 90% power.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb49-2" title="2">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb49-3" title="3">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb49-4" title="4">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb49-5" title="5">                   <span class="dt">labelnames =</span> labelnames)</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power effect_size
## anova_condition    94     0.09751
## 
## Power and Effect sizes for contrasts
##                                   power effect_size
## p_condition_control_condition_cat    45      0.3862
## p_condition_control_condition_dog    94      0.7586
## p_condition_cat_condition_dog        48      0.3708</code></pre>
<p>The simulation confirms that for the <em>F</em>-test for the ANOVA we have 90% power. This is also what g*power tells us what would happen based on a post-hoc power analysis with an f of 0.2934417, 3 groups, 150 participants in total (50 in each between subject condition), and an alpha of 5%.</p>
<p><img src="screenshots/gpower_7.png" /></p>
<p>We can also compute the power for the ANOVA and simple effects in R with the pwr package. The calculated effect sizes and power match those from the simulation.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">K &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb52-2" title="2">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb52-3" title="3">sd &lt;-<span class="st"> </span><span class="fl">6.4</span></a>
<a class="sourceLine" id="cb52-4" title="4">f &lt;-<span class="st"> </span><span class="fl">0.2934417</span></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="kw">pwr.anova.test</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb52-6" title="6">               <span class="dt">k =</span> K,</a>
<a class="sourceLine" id="cb52-7" title="7">               <span class="dt">f =</span> f,</a>
<a class="sourceLine" id="cb52-8" title="8">               <span class="dt">sig.level =</span> alpha_level)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.9000112</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">d &lt;-<span class="st"> </span><span class="fl">2.300104</span><span class="op">/</span><span class="fl">6.4</span></a>
<a class="sourceLine" id="cb54-2" title="2">d</a></code></pre></div>
<pre><code>## [1] 0.3593912</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">2.300104</span><span class="op">/</span><span class="fl">6.4</span>,</a>
<a class="sourceLine" id="cb56-2" title="2">           <span class="dt">n =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb56-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb56-4" title="4">           <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb56-5" title="5">           <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.4284243</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">d &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="fl">2.300104</span><span class="op">/</span><span class="fl">6.4</span></a>
<a class="sourceLine" id="cb58-2" title="2">d</a></code></pre></div>
<pre><code>## [1] 0.7187825</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> d,</a>
<a class="sourceLine" id="cb60-2" title="2">           <span class="dt">n =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb60-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb60-4" title="4">           <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb60-5" title="5">           <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.9450353</code></pre>
<p>We can also compare the results against the analytic solution by Aberson (2019).</p>
<p>First, load the function for a 3-way ANOVA.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">anova1f_<span class="dv">3</span>&lt;-<span class="cf">function</span>(<span class="dt">m1=</span><span class="ot">NULL</span>,<span class="dt">m2=</span><span class="ot">NULL</span>,<span class="dt">m3=</span><span class="ot">NULL</span>,<span class="dt">s1=</span><span class="ot">NULL</span>,<span class="dt">s2=</span><span class="ot">NULL</span>,<span class="dt">s3=</span><span class="ot">NULL</span>,<span class="dt">n1=</span><span class="ot">NULL</span>,<span class="dt">n2=</span><span class="ot">NULL</span>,<span class="dt">n3=</span><span class="ot">NULL</span>,<span class="dt">alpha=</span>.<span class="dv">05</span>){</a>
<a class="sourceLine" id="cb62-2" title="2">x&lt;-stats<span class="op">::</span><span class="kw">rnorm</span>(n1,m1,s1)</a>
<a class="sourceLine" id="cb62-3" title="3">X&lt;-x</a>
<a class="sourceLine" id="cb62-4" title="4">MEAN&lt;-m1</a>
<a class="sourceLine" id="cb62-5" title="5">SD&lt;-s1</a>
<a class="sourceLine" id="cb62-6" title="6">Z &lt;-<span class="st"> </span>(((X <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span>stats<span class="op">::</span><span class="kw">sd</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">*</span><span class="st"> </span>SD</a>
<a class="sourceLine" id="cb62-7" title="7">y&lt;-MEAN <span class="op">+</span><span class="st"> </span>Z</a>
<a class="sourceLine" id="cb62-8" title="8">group&lt;-<span class="kw">rep</span>(<span class="st">&quot;A1&quot;</span>,n1)</a>
<a class="sourceLine" id="cb62-9" title="9">l1&lt;-<span class="kw">data.frame</span>(y, group)</a>
<a class="sourceLine" id="cb62-10" title="10">x&lt;-stats<span class="op">::</span><span class="kw">rnorm</span>(n2,m2,s2)</a>
<a class="sourceLine" id="cb62-11" title="11">X&lt;-x</a>
<a class="sourceLine" id="cb62-12" title="12">MEAN&lt;-m2</a>
<a class="sourceLine" id="cb62-13" title="13">SD&lt;-s2</a>
<a class="sourceLine" id="cb62-14" title="14">Z &lt;-<span class="st"> </span>(((X <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span>stats<span class="op">::</span><span class="kw">sd</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">*</span><span class="st"> </span>SD</a>
<a class="sourceLine" id="cb62-15" title="15">y&lt;-MEAN <span class="op">+</span><span class="st"> </span>Z</a>
<a class="sourceLine" id="cb62-16" title="16">group&lt;-<span class="kw">rep</span>(<span class="st">&quot;A2&quot;</span>,n2)</a>
<a class="sourceLine" id="cb62-17" title="17">l2&lt;-<span class="kw">data.frame</span>(y, group)</a>
<a class="sourceLine" id="cb62-18" title="18">x&lt;-stats<span class="op">::</span><span class="kw">rnorm</span>(n3,m3,s3)</a>
<a class="sourceLine" id="cb62-19" title="19">X&lt;-x</a>
<a class="sourceLine" id="cb62-20" title="20">MEAN&lt;-m3</a>
<a class="sourceLine" id="cb62-21" title="21">SD&lt;-s3</a>
<a class="sourceLine" id="cb62-22" title="22">Z &lt;-<span class="st"> </span>(((X <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span>stats<span class="op">::</span><span class="kw">sd</span>(X, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">*</span><span class="st"> </span>SD</a>
<a class="sourceLine" id="cb62-23" title="23">y&lt;-MEAN <span class="op">+</span><span class="st"> </span>Z</a>
<a class="sourceLine" id="cb62-24" title="24">group&lt;-<span class="kw">rep</span>(<span class="st">&quot;A3&quot;</span>,n3)</a>
<a class="sourceLine" id="cb62-25" title="25">l3&lt;-<span class="kw">data.frame</span>(y, group)</a>
<a class="sourceLine" id="cb62-26" title="26">simdat&lt;-<span class="kw">rbind</span>(l1,l2,l3)</a>
<a class="sourceLine" id="cb62-27" title="27">anova&lt;-stats<span class="op">::</span><span class="kw">aov</span>(y<span class="op">~</span>group, <span class="dt">data=</span>simdat)</a>
<a class="sourceLine" id="cb62-28" title="28">anova&lt;-car<span class="op">::</span><span class="kw">Anova</span>(anova, <span class="dt">type=</span><span class="st">&quot;III&quot;</span>)</a>
<a class="sourceLine" id="cb62-29" title="29">SSA&lt;-anova[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co">#column, row</span></a>
<a class="sourceLine" id="cb62-30" title="30">SSwin&lt;-anova[<span class="dv">3</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb62-31" title="31">dfwin&lt;-anova[<span class="dv">3</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb62-32" title="32">dfbg&lt;-anova[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb62-33" title="33">eta2&lt;-SSA<span class="op">/</span>(SSA<span class="op">+</span>SSwin)</a>
<a class="sourceLine" id="cb62-34" title="34">f2&lt;-eta2<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>eta2)</a>
<a class="sourceLine" id="cb62-35" title="35">lambda&lt;-f2<span class="op">*</span>dfwin</a>
<a class="sourceLine" id="cb62-36" title="36">minusalpha&lt;-<span class="dv">1</span><span class="op">-</span>alpha</a>
<a class="sourceLine" id="cb62-37" title="37">Ft&lt;-stats<span class="op">::</span><span class="kw">qf</span>(minusalpha, dfbg, dfwin)</a>
<a class="sourceLine" id="cb62-38" title="38">power&lt;-<span class="dv">1</span><span class="op">-</span>stats<span class="op">::</span><span class="kw">pf</span>(Ft, dfbg,dfwin,lambda)</a>
<a class="sourceLine" id="cb62-39" title="39"><span class="kw">list</span>(<span class="dt">Power =</span> power)}</a></code></pre></div>
<p>Then we use the function to calculate power.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co">#Initial example, low power</span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">anova1f_3</span>(<span class="dt">m1=</span><span class="dv">24</span>, <span class="dt">m2=</span><span class="fl">26.2</span>, <span class="dt">m3=</span><span class="fl">26.6</span>, <span class="dt">s1=</span><span class="fl">6.4</span>, <span class="dt">s2=</span><span class="fl">6.4</span>, <span class="dt">s3=</span><span class="fl">6.4</span>, <span class="dt">n1=</span><span class="dv">50</span>, <span class="dt">n2=</span><span class="dv">50</span>, <span class="dt">n3=</span><span class="dv">50</span>, <span class="dt">alpha=</span>.<span class="dv">05</span>)</a></code></pre></div>
<pre><code>## $Power
## [1] 0.4769468</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co">#From: Aberson, Christopher L. Applied Power Analysis for the Behavioral Sciences, 2nd Edition. </span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="co"># $Power [1] 0.4769468</span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="co">#Later example, based on larger mean difference</span></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="kw">anova1f_3</span>(<span class="dt">m1=</span><span class="op">-</span><span class="fl">2.300104</span>, <span class="dt">m2=</span><span class="dv">0</span>, <span class="dt">m3=</span><span class="fl">2.300104</span>, <span class="dt">s1=</span><span class="fl">6.4</span>, <span class="dt">s2=</span><span class="fl">6.4</span>, <span class="dt">s3=</span><span class="fl">6.4</span>, <span class="dt">n1=</span><span class="dv">50</span>, <span class="dt">n2=</span><span class="dv">50</span>, <span class="dt">n3=</span><span class="dv">50</span>, <span class="dt">alpha=</span>.<span class="dv">05</span>)</a></code></pre></div>
<pre><code>## $Power
## [1] 0.9000112</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co"># $Power [1] 0.9000112</span></a></code></pre></div>

</div>
<div id="one-way-anova-part-3" class="section level2">
<h2><span class="header-section-number">3.3</span> One-way ANOVA Part 3</h2>
<p>We first repeat the simulation by Brysbaert:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># Simulations to estimate the power of an ANOVA with three unrelated groups</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="co"># the effect between the two extreme groups is set to d = .4, the effect for the third group is d = .4 (see below for other situations)</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co"># we use the built-in aov-test command</span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="co"># give sample sizes (all samples sizes are equal)</span></a>
<a class="sourceLine" id="cb68-5" title="5">N =<span class="st"> </span><span class="dv">90</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co"># give effect size d</span></a>
<a class="sourceLine" id="cb68-7" title="7">d1 =<span class="st"> </span><span class="fl">.4</span> <span class="co">#difference between the extremes</span></a>
<a class="sourceLine" id="cb68-8" title="8">d2 =<span class="st"> </span><span class="fl">.4</span> <span class="co">#third condition goes with the highest extreme</span></a>
<a class="sourceLine" id="cb68-9" title="9"><span class="co"># give number of simulations</span></a>
<a class="sourceLine" id="cb68-10" title="10">nSim =<span class="st"> </span>nsims</a>
<a class="sourceLine" id="cb68-11" title="11"><span class="co"># give alpha levels</span></a>
<a class="sourceLine" id="cb68-12" title="12">alpha1 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for the omnibus ANOVA</span></a>
<a class="sourceLine" id="cb68-13" title="13">alpha2 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for three post hoc one-tailed t-tests Bonferroni correction</span></a>
<a class="sourceLine" id="cb68-14" title="14"><span class="co"># create progress bar in case it takes a while</span></a>
<a class="sourceLine" id="cb68-15" title="15"><span class="co">#pb &lt;- winProgressBar(title = &quot;progress bar&quot;, min = 0, max = nSim, width = 300)</span></a>
<a class="sourceLine" id="cb68-16" title="16"><span class="co"># create vectors to store p-values</span></a>
<a class="sourceLine" id="cb68-17" title="17">p1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value omnibus ANOVA</span></a>
<a class="sourceLine" id="cb68-18" title="18">p2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value first post hoc test</span></a>
<a class="sourceLine" id="cb68-19" title="19">p3 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value second post hoc test</span></a>
<a class="sourceLine" id="cb68-20" title="20">p4 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value third post hoc test</span></a>
<a class="sourceLine" id="cb68-21" title="21">pes1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared</span></a>
<a class="sourceLine" id="cb68-22" title="22">pes2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared two extreme conditions</span></a>
<a class="sourceLine" id="cb68-23" title="23"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb68-24" title="24"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSim){ <span class="co">#for each simulated experiment</span></a>
<a class="sourceLine" id="cb68-25" title="25"> <span class="co"># setWinProgressBar(pb, i, title=paste(round(i/nSim*100, 1), &quot;% done&quot;))</span></a>
<a class="sourceLine" id="cb68-26" title="26">  x&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb68-27" title="27">  y&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d1, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb68-28" title="28">  z&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d2, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb68-29" title="29">  data =<span class="st"> </span><span class="kw">c</span>(x,y,z)</a>
<a class="sourceLine" id="cb68-30" title="30">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">26</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb68-31" title="31">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb68-32" title="32">  pes1[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb68-33" title="33">  p1[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(test)[[<span class="dv">1</span>]][[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb68-34" title="34">  p2[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,y)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb68-35" title="35">  p3[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb68-36" title="36">  p4[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(y,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb68-37" title="37">  data =<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb68-38" title="38">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb68-39" title="39">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb68-40" title="40">  pes2[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb68-41" title="41">  }</a>
<a class="sourceLine" id="cb68-42" title="42"><span class="co">#close(pb)#close progress bar</span></a>
<a class="sourceLine" id="cb68-43" title="43"><span class="co"># results are as predicted when omnibus ANOVA is significant, t-tests are significant between x and y plus x and z; not significant between y and z</span></a>
<a class="sourceLine" id="cb68-44" title="44"><span class="co">#printing all unique tests (adjusted code by DL)</span></a>
<a class="sourceLine" id="cb68-45" title="45"><span class="kw">sum</span>(p1<span class="op">&lt;</span>alpha1)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.83</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">sum</span>(p2<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.77</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">sum</span>(p3<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.74</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">sum</span>(p4<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.07</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">mean</span>(pes1)</a></code></pre></div>
<pre><code>## [1] 0.03880447</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">mean</span>(pes2)</a></code></pre></div>
<pre><code>## [1] 0.04190195</code></pre>
</div>
<div id="three-conditions-replication" class="section level2">
<h2><span class="header-section-number">3.4</span> Three conditions replication</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">K &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb80-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb80-3" title="3">n &lt;-<span class="st"> </span><span class="dv">90</span></a>
<a class="sourceLine" id="cb80-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb80-5" title="5">r &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb80-6" title="6">design =<span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span>string,</a>
<a class="sourceLine" id="cb81-2" title="2">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb81-3" title="3">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb81-4" title="4">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb81-5" title="5">                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>))</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1    79     0.04436
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2    70     0.40690
## p_factor1_level1_factor1_level3    82     0.42600
## p_factor1_level2_factor1_level3     2     0.01956</code></pre>
</div>
<div id="variation-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Variation 1</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># give sample sizes (all samples sizes are equal)</span></a>
<a class="sourceLine" id="cb84-2" title="2">N =<span class="st"> </span><span class="dv">145</span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="co"># give effect size d</span></a>
<a class="sourceLine" id="cb84-4" title="4">d1 =<span class="st"> </span><span class="fl">.4</span> <span class="co">#difference between the extremes</span></a>
<a class="sourceLine" id="cb84-5" title="5">d2 =<span class="st"> </span><span class="fl">.0</span> <span class="co">#third condition goes with the highest extreme</span></a>
<a class="sourceLine" id="cb84-6" title="6"><span class="co"># give number of simulations</span></a>
<a class="sourceLine" id="cb84-7" title="7">nSim =<span class="st"> </span>nsims</a>
<a class="sourceLine" id="cb84-8" title="8"><span class="co"># give alpha levels</span></a>
<a class="sourceLine" id="cb84-9" title="9">alpha1 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for the omnibus ANOVA</span></a>
<a class="sourceLine" id="cb84-10" title="10">alpha2 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for three post hoc one-tailed t-tests Bonferroni correction</span></a>
<a class="sourceLine" id="cb84-11" title="11"><span class="co"># create progress bar in case it takes a while</span></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="co">#pb &lt;- winProgressBar(title = &quot;progress bar&quot;, min = 0, max = nSim, width = 300)</span></a>
<a class="sourceLine" id="cb84-13" title="13"><span class="co"># create vectors to store p-values</span></a>
<a class="sourceLine" id="cb84-14" title="14">p1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value omnibus ANOVA</span></a>
<a class="sourceLine" id="cb84-15" title="15">p2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value first post hoc test</span></a>
<a class="sourceLine" id="cb84-16" title="16">p3 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value second post hoc test</span></a>
<a class="sourceLine" id="cb84-17" title="17">p4 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value third post hoc test</span></a>
<a class="sourceLine" id="cb84-18" title="18">pes1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared</span></a>
<a class="sourceLine" id="cb84-19" title="19">pes2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared two extreme conditions</span></a>
<a class="sourceLine" id="cb84-20" title="20"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb84-21" title="21"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSim){ <span class="co">#for each simulated experiment</span></a>
<a class="sourceLine" id="cb84-22" title="22"> <span class="co"># setWinProgressBar(pb, i, title=paste(round(i/nSim*100, 1), &quot;% done&quot;))</span></a>
<a class="sourceLine" id="cb84-23" title="23">  x&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-24" title="24">  y&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d1, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb84-25" title="25">  z&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d2, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb84-26" title="26">  data =<span class="st"> </span><span class="kw">c</span>(x,y,z)</a>
<a class="sourceLine" id="cb84-27" title="27">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">26</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb84-28" title="28">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb84-29" title="29">  pes1[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb84-30" title="30">  p1[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(test)[[<span class="dv">1</span>]][[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb84-31" title="31">  p2[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,y)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb84-32" title="32">  p3[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb84-33" title="33">  p4[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(y,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb84-34" title="34">  data =<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb84-35" title="35">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb84-36" title="36">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb84-37" title="37">  pes2[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb84-38" title="38">  }</a>
<a class="sourceLine" id="cb84-39" title="39"><span class="co">#close(pb)#close progress bar</span></a>
<a class="sourceLine" id="cb84-40" title="40"><span class="co"># results are as predicted when omnibus ANOVA is significant, t-tests are significant between x and y plus x and z; not significant between y and z</span></a>
<a class="sourceLine" id="cb84-41" title="41"><span class="co">#printing all unique tests (adjusted code by DL)</span></a>
<a class="sourceLine" id="cb84-42" title="42"><span class="kw">sum</span>(p1<span class="op">&lt;</span>alpha1)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.96</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">sum</span>(p2<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.92</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">sum</span>(p3<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">sum</span>(p4<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.91</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">mean</span>(pes1)</a></code></pre></div>
<pre><code>## [1] 0.03828796</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">mean</span>(pes2)</a></code></pre></div>
<pre><code>## [1] 0.04139193</code></pre>
</div>
<div id="three-conditions-replication-1" class="section level2">
<h2><span class="header-section-number">3.6</span> Three conditions replication</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">K &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb96-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.0</span>)</a>
<a class="sourceLine" id="cb96-3" title="3">n &lt;-<span class="st"> </span><span class="dv">145</span></a>
<a class="sourceLine" id="cb96-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb96-5" title="5">r &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb96-6" title="6">design =<span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span>string,</a>
<a class="sourceLine" id="cb97-2" title="2">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb97-3" title="3">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb97-4" title="4">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb97-5" title="5">                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>))</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1    94     0.03837
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2    91     0.39489
## p_factor1_level1_factor1_level3     5    -0.00635
## p_factor1_level2_factor1_level3    94    -0.39989</code></pre>
</div>
<div id="variation-2" class="section level2">
<h2><span class="header-section-number">3.7</span> Variation 2</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="co"># give sample sizes (all samples sizes are equal)</span></a>
<a class="sourceLine" id="cb100-2" title="2">N =<span class="st"> </span><span class="dv">82</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="co"># give effect size d</span></a>
<a class="sourceLine" id="cb100-4" title="4">d1 =<span class="st"> </span><span class="fl">.4</span> <span class="co">#difference between the extremes</span></a>
<a class="sourceLine" id="cb100-5" title="5">d2 =<span class="st"> </span><span class="fl">.2</span> <span class="co">#third condition goes with the highest extreme</span></a>
<a class="sourceLine" id="cb100-6" title="6"><span class="co"># give number of simulations</span></a>
<a class="sourceLine" id="cb100-7" title="7">nSim =<span class="st"> </span>nsims</a>
<a class="sourceLine" id="cb100-8" title="8"><span class="co"># give alpha levels</span></a>
<a class="sourceLine" id="cb100-9" title="9">alpha1 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for the omnibus ANOVA</span></a>
<a class="sourceLine" id="cb100-10" title="10">alpha2 =<span class="st"> </span><span class="fl">.05</span> <span class="co">#alpha level for three post hoc one-tailed t-tests Bonferroni correction</span></a>
<a class="sourceLine" id="cb100-11" title="11"><span class="co"># create progress bar in case it takes a while</span></a>
<a class="sourceLine" id="cb100-12" title="12"><span class="co">#pb &lt;- winProgressBar(title = &quot;progress bar&quot;, min = 0, max = nSim, width = 300)</span></a>
<a class="sourceLine" id="cb100-13" title="13"><span class="co"># create vectors to store p-values</span></a>
<a class="sourceLine" id="cb100-14" title="14">p1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value omnibus ANOVA</span></a>
<a class="sourceLine" id="cb100-15" title="15">p2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value first post hoc test</span></a>
<a class="sourceLine" id="cb100-16" title="16">p3 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value second post hoc test</span></a>
<a class="sourceLine" id="cb100-17" title="17">p4 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#p-value third post hoc test</span></a>
<a class="sourceLine" id="cb100-18" title="18">pes1 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared</span></a>
<a class="sourceLine" id="cb100-19" title="19">pes2 &lt;-<span class="kw">numeric</span>(nSim) <span class="co">#partial eta-squared two extreme conditions</span></a>
<a class="sourceLine" id="cb100-20" title="20"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb100-21" title="21"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSim){ <span class="co">#for each simulated experiment</span></a>
<a class="sourceLine" id="cb100-22" title="22"> <span class="co"># setWinProgressBar(pb, i, title=paste(round(i/nSim*100, 1), &quot;% done&quot;))</span></a>
<a class="sourceLine" id="cb100-23" title="23">  x&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb100-24" title="24">  y&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d1, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb100-25" title="25">  z&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> N, <span class="dt">mean =</span> d2, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb100-26" title="26">  data =<span class="st"> </span><span class="kw">c</span>(x,y,z)</a>
<a class="sourceLine" id="cb100-27" title="27">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">26</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb100-28" title="28">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb100-29" title="29">  pes1[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb100-30" title="30">  p1[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(test)[[<span class="dv">1</span>]][[<span class="st">&quot;Pr(&gt;F)&quot;</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb100-31" title="31">  p2[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,y)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb100-32" title="32">  p3[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb100-33" title="33">  p4[i] &lt;-<span class="st"> </span><span class="kw">t.test</span>(y,z)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb100-34" title="34">  data =<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb100-35" title="35">  groups=<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(letters[<span class="dv">24</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">each =</span> N))</a>
<a class="sourceLine" id="cb100-36" title="36">  test &lt;-<span class="st"> </span><span class="kw">aov</span>(data<span class="op">~</span>groups)</a>
<a class="sourceLine" id="cb100-37" title="37">  pes2[i] &lt;-<span class="st"> </span><span class="kw">etaSquared</span>(test)[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb100-38" title="38">  }</a>
<a class="sourceLine" id="cb100-39" title="39"><span class="co">#close(pb)#close progress bar</span></a>
<a class="sourceLine" id="cb100-40" title="40"><span class="co"># results are as predicted when omnibus ANOVA is significant, t-tests are significant between x and y plus x and z; not significant between y and z</span></a>
<a class="sourceLine" id="cb100-41" title="41"><span class="co">#printing all unique tests (adjusted code by DL)</span></a>
<a class="sourceLine" id="cb100-42" title="42"><span class="kw">sum</span>(p1<span class="op">&lt;</span>alpha1)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.65</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">sum</span>(p2<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.74</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">sum</span>(p3<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.19</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">sum</span>(p4<span class="op">&lt;</span>alpha2)<span class="op">/</span>nSim</a></code></pre></div>
<pre><code>## [1] 0.29</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">mean</span>(pes1)</a></code></pre></div>
<pre><code>## [1] 0.03435332</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">mean</span>(pes2)</a></code></pre></div>
<pre><code>## [1] 0.04559241</code></pre>
</div>
<div id="three-conditions-replication-2" class="section level2">
<h2><span class="header-section-number">3.8</span> Three conditions replication</h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">K &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb112-2" title="2">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb112-3" title="3">n &lt;-<span class="st"> </span><span class="dv">82</span></a>
<a class="sourceLine" id="cb112-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb112-5" title="5">design =<span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span>string,</a>
<a class="sourceLine" id="cb113-2" title="2">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb113-3" title="3">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb113-4" title="4">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb113-5" title="5">                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>))</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1    59     0.03177
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2    70      0.3805
## p_factor1_level1_factor1_level3    25      0.1839
## p_factor1_level2_factor1_level3    24     -0.1966</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures-anova-part-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
