<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Analytic Power for Three-way Interactions | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Analytic Power for Three-way Interactions | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Analytic Power for Three-way Interactions | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="explore-increase-in-effect-size-for-moderated-interactions-.html"/>
<link rel="next" href="power-for-design-variations.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#validation-of-power-in-one-way-anova-part-1"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>2.1.1</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-2-brysbaert-example"><i class="fa fa-check"></i><b>2.2</b> One-way ANOVA Part 2: Brysbaert example</a><ul>
<li class="chapter" data-level="2.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Three conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>2.2.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-3"><i class="fa fa-check"></i><b>2.3</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="2.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication"><i class="fa fa-check"></i><b>2.3.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-1"><i class="fa fa-check"></i><b>2.3.2</b> Variation 1</a></li>
<li class="chapter" data-level="2.3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>2.3.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-2"><i class="fa fa-check"></i><b>2.3.4</b> Variation 2</a></li>
<li class="chapter" data-level="2.3.5" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>2.3.5</b> Three conditions replication</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>3</b> Repeated Measures-ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-2"><i class="fa fa-check"></i><b>3.2</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>3.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="3.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-3"><i class="fa fa-check"></i><b>3.3</b> Repeated Measures-ANOVA Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>3.4</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="3.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>3.5</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>4</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="mixed-anova.html"><a href="mixed-anova.html#part-1-two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>4.1</b> Part 1: Two by two ANOVA, within-between design</a><ul>
<li class="chapter" data-level="4.1.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>4.1.1</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mixed-anova.html"><a href="mixed-anova.html#part-2-two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>4.2</b> Part 2: Two by two ANOVA, within-within design</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.2.1</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mixed-anova.html"><a href="mixed-anova.html#part-3-two-by-two-anova-within-design"><i class="fa fa-check"></i><b>4.3</b> Part 3: Two by two ANOVA, within design</a></li>
<li class="chapter" data-level="4.4" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>4.4</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>5</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="6" data-path="power-for-interactions.html"><a href="power-for-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Interactions</a></li>
<li class="chapter" data-level="7" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>7</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>7.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>7.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="7.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>7.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>7.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>8</b> Power Curve</a></li>
<li class="chapter" data-level="9" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>9</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="9.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>9.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="9.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>9.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="9.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>9.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="11" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html"><i class="fa fa-check"></i><b>11</b> Power for Design Variations</a><ul>
<li class="chapter" data-level="11.1" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html#within-designs"><i class="fa fa-check"></i><b>11.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="setting-the-correlation-matrix.html"><a href="setting-the-correlation-matrix.html"><i class="fa fa-check"></i><b>12</b> Setting the Correlation Matrix</a></li>
<li class="chapter" data-level="13" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html"><i class="fa fa-check"></i><b>13</b> Validation of Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="13.1" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>13.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="13.2" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>13.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="13.3" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>13.3</b> Two conditions, large effect size</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analytic-power-for-three-way-interactions" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Analytic Power for Three-way Interactions</h1>
<p>There are almost no software solutions that allow researchers to perform power anaysis for more complex designs. Through simulation, it is relatively straightforward to examine the power for designs with multiple factors with many levels.</p>
<p>Let’s start with a 2x2x2 between subjects design. We collect 50 participants in each between participant condition (so 400 participants in total - 50x2x2x2).</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1"><span class="co"># With 2x2x2 designs, the names for paired comparisons can become very long. </span></a>
<a class="sourceLine" id="cb346-2" title="2"><span class="co"># So here I abbreviate terms: Size, Color, and Cognitive Load, have values:</span></a>
<a class="sourceLine" id="cb346-3" title="3"><span class="co"># b = big, s = small, g = green, r = red, pres = present, abs = absent.  </span></a>
<a class="sourceLine" id="cb346-4" title="4">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, </a>
<a class="sourceLine" id="cb346-5" title="5">                <span class="st">&quot;Load&quot;</span>, <span class="st">&quot;pres&quot;</span>, <span class="st">&quot;abs&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb346-6" title="6">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b*2b*2b&quot;</span>, <span class="co">#describe the design</span></a>
<a class="sourceLine" id="cb346-7" title="7">                              <span class="dt">n =</span> <span class="dv">50</span>, <span class="co">#sample size per group </span></a>
<a class="sourceLine" id="cb346-8" title="8">                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">8</span>), <span class="co">#pattern of means</span></a>
<a class="sourceLine" id="cb346-9" title="9">                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span></a>
<a class="sourceLine" id="cb346-10" title="10">                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span></a>
<a class="sourceLine" id="cb346-11" title="11"><span class="co"># Power based on simulations</span></a>
<a class="sourceLine" id="cb346-12" title="12"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                       power effect_size
## anova_Size               67    0.017239
## anova_Color               5    0.002428
## anova_Load                6    0.002964
## anova_Size:Color         30    0.007900
## anova_Size:Load          77    0.022533
## anova_Color:Load          9    0.003171
## anova_Size:Color:Load    85    0.024190
## 
## Power and Effect sizes for contrasts
##                                                     power effect_size
## p_Size_b_Color_g_Load_pres_Size_b_Color_g_Load_abs      8   0.0226707
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_pres    50   0.4240553
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_abs      4  -0.0748963
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_pres    53   0.4177005
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_abs     47   0.4093716
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_pres     7  -0.0770415
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_abs     86   0.5935411
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_pres     43   0.4023635
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_abs       8  -0.0960864
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_pres     54   0.3965005
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_abs      49   0.3878841
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_pres      9  -0.0988835
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_abs      75   0.5751378
## p_Size_b_Color_r_Load_pres_Size_b_Color_r_Load_abs     70  -0.5024517
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_pres     5   0.0004742
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_abs      5  -0.0096895
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_pres    72  -0.4981884
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_abs     11   0.1809308
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_pres     65   0.4946308
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_abs      66   0.4893591
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_pres      4  -0.0029437
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_abs      95   0.6753933
## p_Size_s_Color_g_Load_pres_Size_s_Color_g_Load_abs      3  -0.0090681
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_pres    69  -0.4949451
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_abs     14   0.1794844
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_pres     66  -0.4847046
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_abs      12   0.1894058
## p_Size_s_Color_r_Load_pres_Size_s_Color_r_Load_abs     91   0.6690142</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1"><span class="co"># Power based on exact simulation</span></a>
<a class="sourceLine" id="cb348-2" title="2">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power partial_eta_squared cohen_f non_centrality
## Size            70.33              0.0157  0.1263           6.25
## Color            5.00              0.0000  0.0000           0.00
## Load             7.90              0.0006  0.0253           0.25
## Size:Color      32.17              0.0057  0.0758           2.25
## Size:Load       84.91              0.0224  0.1515           9.00
## Color:Load       7.90              0.0006  0.0253           0.25
## Size:Color:Load 84.91              0.0224  0.1515           9.00
## 
## Power and Effect sizes for contrasts
##                                                     power effect_size
## p_Size_b_Color_g_Load_pres_Size_b_Color_g_Load_abs   5.00         0.0
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_pres 50.82         0.4
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_abs   7.85        -0.1
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_pres 50.82         0.4
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_abs  50.82         0.4
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_pres  7.85        -0.1
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_abs  84.39         0.6
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_pres  50.82         0.4
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_abs    7.85        -0.1
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_pres  50.82         0.4
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_abs   50.82         0.4
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_pres   7.85        -0.1
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_abs   84.39         0.6
## p_Size_b_Color_r_Load_pres_Size_b_Color_r_Load_abs  69.69        -0.5
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_pres  5.00         0.0
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_abs   5.00         0.0
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_pres 69.69        -0.5
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_abs  16.77         0.2
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_pres  69.69         0.5
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_abs   69.69         0.5
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_pres   5.00         0.0
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_abs   93.39         0.7
## p_Size_s_Color_g_Load_pres_Size_s_Color_g_Load_abs   5.00         0.0
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_pres 69.69        -0.5
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_abs  16.77         0.2
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_pres  69.69        -0.5
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_abs   16.77         0.2
## p_Size_s_Color_r_Load_pres_Size_s_Color_r_Load_abs  93.39         0.7</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="co">#Analytical power calculation</span></a>
<a class="sourceLine" id="cb350-2" title="2">power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)</a>
<a class="sourceLine" id="cb350-3" title="3">power_analytic<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.7033333</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" title="1">power_analytic<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" title="1">power_analytic<span class="op">$</span>power_C</a></code></pre></div>
<pre><code>## [1] 0.07895539</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb356-1" title="1">power_analytic<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.3217471</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" title="1">power_analytic<span class="op">$</span>power_AC</a></code></pre></div>
<pre><code>## [1] 0.8491491</code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb360-1" title="1">power_analytic<span class="op">$</span>power_BC</a></code></pre></div>
<pre><code>## [1] 0.07895539</code></pre>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb362-1" title="1">power_analytic<span class="op">$</span>power_ABC</a></code></pre></div>
<pre><code>## [1] 0.8491491</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb364-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</a></code></pre></div>
<pre><code>## [1] 0.01538462</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb366-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_B</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb368-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_C</a></code></pre></div>
<pre><code>## [1] 0.0006246096</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb370-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AB</a></code></pre></div>
<pre><code>## [1] 0.005593536</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb372-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AC</a></code></pre></div>
<pre><code>## [1] 0.02200489</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb374-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_BC</a></code></pre></div>
<pre><code>## [1] 0.0006246096</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_ABC</a></code></pre></div>
<pre><code>## [1] 0.02200489</code></pre>
<p>We can also confirm the power analysis in GPower. GPower allows you to compute the power for a three-way interaction - if you know the Cohen’s f value to enter. Cohen’s f is calculated based on the means for the interaction, the sum of squares of the effect, and the sum of squares of the errors. This is quite a challenge by hand, but we can simulate the results, or use the analytical solution we programmed to get Cohen’s f for the pattern of means that we specified.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb378-1" title="1"><span class="co"># The power for the AC interaction (Size x Load) is 0.873535. </span></a>
<a class="sourceLine" id="cb378-2" title="2">power_analytic<span class="op">$</span>power_AC</a></code></pre></div>
<pre><code>## [1] 0.8491491</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb380-1" title="1"><span class="co"># We can enter the Cohen&#39;s f for this interaction. </span></a>
<a class="sourceLine" id="cb380-2" title="2">power_analytic<span class="op">$</span>Cohen_f_AC</a></code></pre></div>
<pre><code>## [1] 0.15</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb382-1" title="1"><span class="co"># We can double check the calculated lambda</span></a>
<a class="sourceLine" id="cb382-2" title="2">power_analytic<span class="op">$</span>lambda_AC</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb384-1" title="1"><span class="co"># We can double check the critical F value</span></a>
<a class="sourceLine" id="cb384-2" title="2">power_analytic<span class="op">$</span>F_critical_AC</a></code></pre></div>
<pre><code>## [1] 3.864929</code></pre>
<p><img src="screenshots/gpower_8.png" /></p>
<p>A Three-Way ANOVA builds on the same principles as a One_Way ANOVA. We look at whether the differences between groups are large, compared to the standard deviation. For the main effects we simply have 2 groups of 200 participants, and 2 means. If the population standard deviations are identical across groups, this is not in any way different from a One-Way ANOVA. Indeed, we can show this by simulating a One-Way ANOVA, where instead of 8 conditions, we have two conditions, and we average over the 4 groups of the other two factors. For example, for the main effect of size above can be computed analytically. There might be a small difference in the degrees of freedom of the two tests, or it is just random variation (And it will disappear when repeating the simulation 1000.000 times instead of 100.000.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" title="1">string &lt;-<span class="st"> &quot;2b&quot;</span></a>
<a class="sourceLine" id="cb386-2" title="2">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb386-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">8</span>)))</a>
<a class="sourceLine" id="cb386-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb386-5" title="5">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>)</a>
<a class="sourceLine" id="cb386-6" title="6">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb386-7" title="7">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb386-8" title="8">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb386-9" title="9">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb386-10" title="10">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb386-11" title="11"><span class="co"># Power based on simulations</span></a>
<a class="sourceLine" id="cb386-12" title="12">simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##            power effect_size
## anova_Size    70     0.01896
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_Size_big_Size_small    70      0.2568</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" title="1"><span class="co"># Power based on exact simulation</span></a>
<a class="sourceLine" id="cb388-2" title="2">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##      power partial_eta_squared cohen_f non_centrality
## Size 70.33              0.0155  0.1253           6.25
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_Size_big_Size_small 70.33        0.25</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" title="1"><span class="co"># Power based on analytical solution</span></a>
<a class="sourceLine" id="cb390-2" title="2"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power <span class="co">#using default alpha level of .05</span></a></code></pre></div>
<pre><code>## [1] 0.7033333</code></pre>
<p>Similarly, we can create a 2 factor design where we average over the third factor, and recreate the power analysis for the Two-Way interaction. For example, we can group over the Cognitive Load condition, and look at the Size by Color Interaction:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb392-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb392-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">6</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb392-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb392-5" title="5">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb392-6" title="6">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb392-7" title="7">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb392-8" title="8">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb392-9" title="9">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb392-10" title="10">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb392-11" title="11"><span class="co"># Power based on simulations</span></a>
<a class="sourceLine" id="cb392-12" title="12">simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                  power effect_size
## anova_Size          85    0.019608
## anova_Color          3    0.002841
## anova_Size:Color    68    0.017722
## 
## Power and Effect sizes for contrasts
##                                               power effect_size
## p_Size_big_Color_green_Size_big_Color_red        47     0.25456
## p_Size_big_Color_green_Size_small_Color_green    96     0.51540
## p_Size_big_Color_green_Size_small_Color_red      48     0.27470
## p_Size_big_Color_red_Size_small_Color_green      41     0.26240
## p_Size_big_Color_red_Size_small_Color_red         5     0.02223
## p_Size_small_Color_green_Size_small_Color_red    39    -0.23927</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" title="1"><span class="co"># Power based on exact simulation</span></a>
<a class="sourceLine" id="cb394-2" title="2">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##            power partial_eta_squared cohen_f non_centrality
## Size       70.33              0.0155  0.1256           6.25
## Color       5.00              0.0000  0.0000           0.00
## Size:Color 70.33              0.0155  0.1256           6.25
## 
## Power and Effect sizes for contrasts
##                                               power effect_size
## p_Size_big_Color_green_Size_big_Color_red     42.05        0.25
## p_Size_big_Color_green_Size_small_Color_green 94.04        0.50
## p_Size_big_Color_green_Size_small_Color_red   42.05        0.25
## p_Size_big_Color_red_Size_small_Color_green   42.05        0.25
## p_Size_big_Color_red_Size_small_Color_red      5.00        0.00
## p_Size_small_Color_green_Size_small_Color_red 42.05       -0.25</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" title="1"><span class="co"># Power based on analytical solution</span></a>
<a class="sourceLine" id="cb396-2" title="2">power_res &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result) <span class="co">#using default alpha level of .05</span></a>
<a class="sourceLine" id="cb396-3" title="3">power_res<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.7033228</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" title="1">power_res<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" title="1">power_res<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.7033228</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb402-1" title="1">string &lt;-<span class="st"> &quot;2b*2b*2b&quot;</span></a>
<a class="sourceLine" id="cb402-2" title="2">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb402-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb402-4" title="4">sd &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb402-5" title="5">r &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb402-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb402-7" title="7">                <span class="st">&quot;CognitiveLoad&quot;</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb402-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb402-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb402-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb402-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb402-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb402-13" title="13"><span class="co"># Power for the given N in the design_result</span></a>
<a class="sourceLine" id="cb402-14" title="14">simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                                power effect_size
## anova_Size                        40    0.009421
## anova_Color                        6    0.002701
## anova_CognitiveLoad               10    0.003362
## anova_Size:Color                   8    0.003061
## anova_Size:CognitiveLoad           3    0.002263
## anova_Color:CognitiveLoad         10    0.003011
## anova_Size:Color:CognitiveLoad    83    0.021636
## 
## Power and Effect sizes for contrasts
##                                                                                            power
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_green_CognitiveLoad_absent        20
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_present         28
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent           8
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present     43
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent       6
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present       16
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent        48
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_present           4
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_absent           37
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present      15
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent       10
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present        12
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent         14
## p_Size_big_Color_red_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent            50
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present        3
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent        12
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present          8
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent           9
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present        63
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent         18
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present          29
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent           67
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent    27
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present     21
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent       2
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present       5
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent       29
## p_Size_small_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent        22
##                                                                                            effect_size
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_green_CognitiveLoad_absent        -0.23483
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_present         -0.28926
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent           0.08990
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present     -0.38044
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent      -0.10106
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present       -0.19435
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent        -0.42058
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_present          -0.05813
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_absent            0.32492
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present      -0.14989
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent        0.13063
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present         0.03541
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent         -0.18651
## p_Size_big_Color_red_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent             0.38445
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present       -0.09277
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent         0.18578
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present          0.09248
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent          -0.12956
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present        -0.47421
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent         -0.19272
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present          -0.28816
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent           -0.51548
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent     0.27698
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present      0.18567
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent      -0.03430
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present      -0.09263
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent       -0.31453
## p_Size_small_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent        -0.22183</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb404-1" title="1"><span class="co"># Exact simulation</span></a>
<a class="sourceLine" id="cb404-2" title="2">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                          power partial_eta_squared cohen_f non_centrality
## Size                     41.53              0.0078  0.0884         3.0625
## Color                     5.72              0.0002  0.0126         0.0625
## CognitiveLoad            11.62              0.0014  0.0379         0.5625
## Size:Color                5.72              0.0002  0.0126         0.0625
## Size:CognitiveLoad        5.72              0.0002  0.0126         0.0625
## Color:CognitiveLoad       5.72              0.0002  0.0126         0.0625
## Size:Color:CognitiveLoad 78.33              0.0189  0.1389         7.5625
## 
## Power and Effect sizes for contrasts
##                                                                                            power
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_green_CognitiveLoad_absent     16.77
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_present      31.78
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent        7.85
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present  50.82
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent    7.85
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present    16.77
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent     50.82
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_present        7.85
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_absent        31.78
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present   16.77
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent     7.85
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present      5.00
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent      16.77
## p_Size_big_Color_red_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent         50.82
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present     7.85
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent     16.77
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present       7.85
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent        7.85
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present     69.69
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent      16.77
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present       31.78
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent        69.69
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent 31.78
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present  16.77
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent    5.00
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present    7.85
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent    31.78
## p_Size_small_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent     16.77
##                                                                                            effect_size
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_green_CognitiveLoad_absent            -0.2
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_present             -0.3
## p_Size_big_Color_green_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent               0.1
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present         -0.4
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent          -0.1
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present           -0.2
## p_Size_big_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent            -0.4
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_present              -0.1
## p_Size_big_Color_green_CognitiveLoad_absent_Size_big_Color_red_CognitiveLoad_absent                0.3
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present          -0.2
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent            0.1
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present             0.0
## p_Size_big_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent             -0.2
## p_Size_big_Color_red_CognitiveLoad_present_Size_big_Color_red_CognitiveLoad_absent                 0.4
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_present           -0.1
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent             0.2
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present              0.1
## p_Size_big_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent              -0.1
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_present            -0.5
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_green_CognitiveLoad_absent             -0.2
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present              -0.3
## p_Size_big_Color_red_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent               -0.5
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_green_CognitiveLoad_absent         0.3
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_present          0.2
## p_Size_small_Color_green_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent           0.0
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_present          -0.1
## p_Size_small_Color_green_CognitiveLoad_absent_Size_small_Color_red_CognitiveLoad_absent           -0.3
## p_Size_small_Color_red_CognitiveLoad_present_Size_small_Color_red_CognitiveLoad_absent            -0.2</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb406-1" title="1"><span class="co">#Analytical power calculation</span></a>
<a class="sourceLine" id="cb406-2" title="2">power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)</a>
<a class="sourceLine" id="cb406-3" title="3">power_analytic<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.415306</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb408-1" title="1">power_analytic<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.05715533</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb410-1" title="1">power_analytic<span class="op">$</span>power_C</a></code></pre></div>
<pre><code>## [1] 0.1161827</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1">power_analytic<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.05715533</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" title="1">power_analytic<span class="op">$</span>power_AC</a></code></pre></div>
<pre><code>## [1] 0.05715533</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb416-1" title="1">power_analytic<span class="op">$</span>power_BC</a></code></pre></div>
<pre><code>## [1] 0.05715533</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb418-1" title="1">power_analytic<span class="op">$</span>power_ABC</a></code></pre></div>
<pre><code>## [1] 0.7833036</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</a></code></pre></div>
<pre><code>## [1] 0.007598077</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_B</a></code></pre></div>
<pre><code>## [1] 0.0001562256</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_C</a></code></pre></div>
<pre><code>## [1] 0.001404275</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AB</a></code></pre></div>
<pre><code>## [1] 0.0001562256</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AC</a></code></pre></div>
<pre><code>## [1] 0.0001562256</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_BC</a></code></pre></div>
<pre><code>## [1] 0.0001562256</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_ABC</a></code></pre></div>
<pre><code>## [1] 0.01855544</code></pre>
<p>The power for interactions depends on Cohen’s <em>f</em>, the alpha level, the sample size, and the degrees of freedom.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1"><span class="co"># With 2x2x2 designs, the names for paired comparisons can become very long. </span></a>
<a class="sourceLine" id="cb434-2" title="2"><span class="co"># So here the sample sizI abbreviate terms: Size, Color, and Cognitive Load, have values:</span></a>
<a class="sourceLine" id="cb434-3" title="3"><span class="co"># b = big, s = small, g = green, r = red, pres = present, abs = absent.  </span></a>
<a class="sourceLine" id="cb434-4" title="4">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, </a>
<a class="sourceLine" id="cb434-5" title="5">                <span class="st">&quot;Load&quot;</span>, <span class="st">&quot;pres&quot;</span>, <span class="st">&quot;abs&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb434-6" title="6">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;3b*2b*2b&quot;</span>, <span class="co">#describe the design</span></a>
<a class="sourceLine" id="cb434-7" title="7">                              <span class="dt">n =</span> <span class="dv">15</span>, <span class="co">#sample size per group </span></a>
<a class="sourceLine" id="cb434-8" title="8">                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">20</span>), <span class="co">#pattern of means</span></a>
<a class="sourceLine" id="cb434-9" title="9">                              <span class="dt">sd =</span> <span class="dv">20</span>, <span class="co">#standard deviation</span></a>
<a class="sourceLine" id="cb434-10" title="10">                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span></a>
<a class="sourceLine" id="cb434-11" title="11"><span class="co"># Power based on exact simulations</span></a>
<a class="sourceLine" id="cb434-12" title="12">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power partial_eta_squared cohen_f non_centrality
## Size            26.93              0.0147  0.1220            2.5
## Color            5.00              0.0000  0.0000            0.0
## Load             5.00              0.0000  0.0000            0.0
## Size:Color      67.93              0.0427  0.2113            7.5
## Size:Load       67.93              0.0427  0.2113            7.5
## Color:Load      60.39              0.0289  0.1725            5.0
## Size:Color:Load 26.93              0.0147  0.1220            2.5
## 
## Power and Effect sizes for contrasts
##                                                     power effect_size
## p_Size_b_Color_g_Load_pres_Size_b_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_g_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_r_Load_abs   5.00           0
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_b_Color_r_Load_pres_Size_b_Color_r_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_s_Color_g_Load_pres_Size_s_Color_g_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_s_Color_r_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_s_Color_r_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_x_Color_g_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_x_Color_g_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_x_Color_g_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_x_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_x_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_x_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1"><span class="co">#Analytical power calculation</span></a>
<a class="sourceLine" id="cb436-2" title="2">power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)</a>
<a class="sourceLine" id="cb436-3" title="3">power_analytic<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1">power_analytic<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1">power_analytic<span class="op">$</span>power_C</a></code></pre></div>
<pre><code>## [1] 0.486496</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1">power_analytic<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.347961</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" title="1">power_analytic<span class="op">$</span>power_AC</a></code></pre></div>
<pre><code>## [1] 0.6797466</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1">power_analytic<span class="op">$</span>power_BC</a></code></pre></div>
<pre><code>## [1] 0.9155713</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" title="1">power_analytic<span class="op">$</span>power_ABC</a></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" title="1">power_analytic<span class="op">$</span>Cohen_f_A</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We see that a pattern of means of 0, 0, 0, 0, 0, 0, 0, 20 for a 2x2x2 interaction equals a Cohen’s f of 0.25.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>)</a>
<a class="sourceLine" id="cb454-2" title="2">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b*2b&quot;</span>, <span class="co">#describe the design</span></a>
<a class="sourceLine" id="cb454-3" title="3">                              <span class="dt">n =</span> <span class="dv">10</span>, <span class="co">#sample size per group </span></a>
<a class="sourceLine" id="cb454-4" title="4">                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="co">#pattern of means</span></a>
<a class="sourceLine" id="cb454-5" title="5">                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span></a>
<a class="sourceLine" id="cb454-6" title="6">                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span></a>
<a class="sourceLine" id="cb454-7" title="7"><span class="co"># Power based on exact simulations</span></a>
<a class="sourceLine" id="cb454-8" title="8">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##            power partial_eta_squared cohen_f non_centrality
## Size       33.71              0.0649  0.2635            2.5
## Color      33.71              0.0649  0.2635            2.5
## Size:Color 33.71              0.0649  0.2635            2.5
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_Size_b_Color_g_Size_b_Color_r   5.0           0
## p_Size_b_Color_g_Size_s_Color_g   5.0           0
## p_Size_b_Color_g_Size_s_Color_r  56.2           1
## p_Size_b_Color_r_Size_s_Color_g   5.0           0
## p_Size_b_Color_r_Size_s_Color_r  56.2           1
## p_Size_s_Color_g_Size_s_Color_r  56.2           1</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1"><span class="co">#Analytical power calculation</span></a>
<a class="sourceLine" id="cb456-2" title="2">power_analytic &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result)</a>
<a class="sourceLine" id="cb456-3" title="3">power_analytic<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.3371329</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</a></code></pre></div>
<pre><code>## [1] 0.05882353</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1">power_analytic<span class="op">$</span>Cohen_f_A</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<p>Cohen’s f is twice as large for a 2x2 design with the same mean value in one of four cells. In a 2 factor between design.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb462-2" title="2">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b&quot;</span>, <span class="co">#describe the design</span></a>
<a class="sourceLine" id="cb462-3" title="3">                              <span class="dt">n =</span> <span class="dv">10</span>, <span class="co">#sample size per group </span></a>
<a class="sourceLine" id="cb462-4" title="4">                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="co">#pattern of means</span></a>
<a class="sourceLine" id="cb462-5" title="5">                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span></a>
<a class="sourceLine" id="cb462-6" title="6">                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span></a>
<a class="sourceLine" id="cb462-7" title="7"><span class="co"># Power based on exact simulations</span></a>
<a class="sourceLine" id="cb462-8" title="8">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##      power partial_eta_squared cohen_f non_centrality
## Size 18.51              0.0649  0.2635           1.25
## 
## Power and Effect sizes for contrasts
##                 power effect_size
## p_Size_b_Size_s 18.51         0.5</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="co">#Analytical power calculation</span></a>
<a class="sourceLine" id="cb464-2" title="2">power_analytic &lt;-<span class="st"> </span><span class="kw">power_oneway_between</span>(design_result)</a>
<a class="sourceLine" id="cb464-3" title="3">power_analytic<span class="op">$</span>power</a></code></pre></div>
<pre><code>## [1] 0.1850957</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.05882353</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1">power_analytic<span class="op">$</span>Cohen_f</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="explore-increase-in-effect-size-for-moderated-interactions-.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-for-design-variations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
