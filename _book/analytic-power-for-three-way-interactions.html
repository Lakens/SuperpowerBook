<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Analytic Power for Three-way Interactions | The Superpower R Package: Capabilities and Validation</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Analytic Power for Three-way Interactions | The Superpower R Package: Capabilities and Validation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Analytic Power for Three-way Interactions | The Superpower R Package: Capabilities and Validation" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mixed-anova.html">
<link rel="next" href="power-for-interactions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Superpower</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design</a><ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>2.1</b> ANOVA_design function</a><ul>
<li class="chapter" data-level="2.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>2.1.1</b> Specifying the design using ‘design’</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>2.1.2</b> Specifying the means using ‘mu’</a></li>
<li class="chapter" data-level="2.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>2.1.3</b> Specifying label names</a></li>
<li class="chapter" data-level="2.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>2.1.4</b> Specifying the correlation</a></li>
<li class="chapter" data-level="2.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>2.1.5</b> Specifying the sample size</a></li>
<li class="chapter" data-level="2.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>2.1.6</b> Specifying the standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#part-2"><i class="fa fa-check"></i><b>3.2</b> Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#part-3"><i class="fa fa-check"></i><b>3.3</b> Part 3</a><ul>
<li class="chapter" data-level="3.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication"><i class="fa fa-check"></i><b>3.3.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-1"><i class="fa fa-check"></i><b>3.3.2</b> Variation 1</a></li>
<li class="chapter" data-level="3.3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>3.3.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-2"><i class="fa fa-check"></i><b>3.3.4</b> Variation 2</a></li>
<li class="chapter" data-level="3.3.5" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>3.3.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.4</b> Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.4.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="3.4.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.4.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="3.4.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.4.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1-1"><i class="fa fa-check"></i><b>4.1</b> Part 1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-2"><i class="fa fa-check"></i><b>4.2</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3-1"><i class="fa fa-check"></i><b>4.3</b> Part 3</a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>4.4</b> Reproducing Brysbaert</a><ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#results"><i class="fa fa-check"></i><b>4.4.1</b> Results</a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#part-1-2"><i class="fa fa-check"></i><b>5.1</b> Part 1</a><ul>
<li class="chapter" data-level="5.1.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>5.1.1</b> Two by two ANOVA, within-between design</a></li>
<li class="chapter" data-level="5.1.2" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>5.1.2</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#part-2-1"><i class="fa fa-check"></i><b>5.2</b> Part 2</a><ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>5.2.1</b> Two by two ANOVA, within-within design</a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>5.2.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mixed-anova.html"><a href="mixed-anova.html#part-3-2"><i class="fa fa-check"></i><b>5.3</b> Part 3</a></li>
<li class="chapter" data-level="5.4" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>5.4</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="7" data-path="power-for-interactions.html"><a href="power-for-interactions.html"><i class="fa fa-check"></i><b>7</b> Power for Interactions</a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power</a><ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="10.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>10.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve</a></li>
<li class="chapter" data-level="12" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>12</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="12.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>12.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="12.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>12.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="12.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>12.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i><b>13</b> Appendix 1: Direct Comparison to <code>pwr2ppl</code></a><ul>
<li class="chapter" data-level="13.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-5"><i class="fa fa-check"></i><b>13.1</b> Examples from Chapter 5</a><ul>
<li class="chapter" data-level="13.1.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>13.1.1</b> Example 5.1/5.2</a></li>
<li class="chapter" data-level="13.1.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>13.1.2</b> Example 5.3</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>13.2</b> Examples from Chapter 6</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>13.2.1</b> Example from Table 6.2</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>13.2.2</b> Example from Table 6.6</a></li>
<li class="chapter" data-level="13.2.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>13.2.3</b> Example from Table 6.8</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>13.3</b> Example from Chapter 7</a><ul>
<li class="chapter" data-level="13.3.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>13.3.1</b> From Table 7.2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Superpower R Package: Capabilities and Validation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analytic-power-for-three-way-interactions" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Analytic Power for Three-way Interactions</h1>
<p>There are almost no software solutions that allow researchers to perform power anaysis for more complex designs. Through simulation, it is relatively straightforward to examine the power for designs with multiple factors with many levels.</p>
<p>Let’s start with a 2x2x2 between subjects design. We collect 50 participants in each between participant condition (so 400 participants in total - 50x2x2x2).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># With 2x2x2 designs, the names for paired comparisons can become very long. </span>
<span class="co"># So here I abbreviate terms: Size, Color, and Cognitive Load, have values:</span>
<span class="co"># b = big, s = small, g = green, r = red, pres = present, abs = absent.  </span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, 
                <span class="st">&quot;Load&quot;</span>, <span class="st">&quot;pres&quot;</span>, <span class="st">&quot;abs&quot;</span>) <span class="co">#</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b*2b*2b&quot;</span>, <span class="co">#describe the design</span>
                              <span class="dt">n =</span> <span class="dv">50</span>, <span class="co">#sample size per group </span>
                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">8</span>), <span class="co">#pattern of means</span>
                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span>
                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span>

simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                                 <span class="dt">alpha_level =</span> alpha_level, 
                                 <span class="dt">nsims =</span> nsims,
                                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(simulation_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Simulated ANOVA Result&quot;</span>)</code></pre>
<table>
<caption>(#tab:start_threewayinteraction)Simulated ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">effect_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anova_Size</td>
<td align="right">70.99</td>
<td align="right">0.0182379</td>
</tr>
<tr class="even">
<td>anova_Color</td>
<td align="right">4.90</td>
<td align="right">0.0025108</td>
</tr>
<tr class="odd">
<td>anova_Load</td>
<td align="right">8.04</td>
<td align="right">0.0031981</td>
</tr>
<tr class="even">
<td>anova_Size:Color</td>
<td align="right">32.22</td>
<td align="right">0.0082517</td>
</tr>
<tr class="odd">
<td>anova_Size:Load</td>
<td align="right">84.50</td>
<td align="right">0.0244223</td>
</tr>
<tr class="even">
<td>anova_Color:Load</td>
<td align="right">7.97</td>
<td align="right">0.0031867</td>
</tr>
<tr class="odd">
<td>anova_Size:Color:Load</td>
<td align="right">85.52</td>
<td align="right">0.0250651</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result,
                            <span class="dt">alpha_level =</span> alpha_level,
                            <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(exact_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Exact ANOVA Result&quot;</span>)</code></pre>
<table>
<caption>(#tab:start_threewayinteraction)Exact ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size</td>
<td align="right">70.33</td>
<td align="right">0.0157</td>
<td align="right">0.1263</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td>Color</td>
<td align="right">5.00</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td>Load</td>
<td align="right">7.90</td>
<td align="right">0.0006</td>
<td align="right">0.0253</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td>Size:Color</td>
<td align="right">32.17</td>
<td align="right">0.0057</td>
<td align="right">0.0758</td>
<td align="right">2.25</td>
</tr>
<tr class="odd">
<td>Size:Load</td>
<td align="right">84.91</td>
<td align="right">0.0224</td>
<td align="right">0.1515</td>
<td align="right">9.00</td>
</tr>
<tr class="even">
<td>Color:Load</td>
<td align="right">7.90</td>
<td align="right">0.0006</td>
<td align="right">0.0253</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td>Size:Color:Load</td>
<td align="right">84.91</td>
<td align="right">0.0224</td>
<td align="right">0.1515</td>
<td align="right">9.00</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analytical power calculation</span>
power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)
power_analytic<span class="op">$</span>power_A</code></pre>
<pre><code>## [1] 70.33333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_B</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_C</code></pre>
<pre><code>## [1] 7.895539</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AB</code></pre>
<pre><code>## [1] 32.17471</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AC</code></pre>
<pre><code>## [1] 84.91491</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_BC</code></pre>
<pre><code>## [1] 7.895539</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_ABC</code></pre>
<pre><code>## [1] 84.91491</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</code></pre>
<pre><code>## [1] 0.01538462</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_B</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_C</code></pre>
<pre><code>## [1] 0.0006246096</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AB</code></pre>
<pre><code>## [1] 0.005593536</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AC</code></pre>
<pre><code>## [1] 0.02200489</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_BC</code></pre>
<pre><code>## [1] 0.0006246096</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_ABC</code></pre>
<pre><code>## [1] 0.02200489</code></pre>
<p>We can also confirm the power analysis in GPower. GPower allows you to compute the power for a three-way interaction - if you know the Cohen’s f value to enter. Cohen’s f is calculated based on the means for the interaction, the sum of squares of the effect, and the sum of squares of the errors. This is quite a challenge by hand, but we can simulate the results, or use the analytical solution we programmed to get Cohen’s f for the pattern of means that we specified.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The power for the AC interaction (Size x Load) is 0.873535. </span>
power_analytic<span class="op">$</span>power_AC</code></pre>
<pre><code>## [1] 84.91491</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can enter the Cohen&#39;s f for this interaction. </span>
power_analytic<span class="op">$</span>Cohen_f_AC</code></pre>
<pre><code>## [1] 0.15</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can double check the calculated lambda</span>
power_analytic<span class="op">$</span>lambda_AC</code></pre>
<pre><code>## [1] 9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can double check the critical F value</span>
power_analytic<span class="op">$</span>F_critical_AC</code></pre>
<pre><code>## [1] 3.864929</code></pre>
<p><img src="screenshots/gpower_8.png" /></p>
<p>A Three-Way ANOVA builds on the same principles as a One_Way ANOVA. We look at whether the differences between groups are large, compared to the standard deviation. For the main effects we simply have 2 groups of 200 participants, and 2 means. If the population standard deviations are identical across groups, this is not in any way different from a One-Way ANOVA. Indeed, we can show this by simulating a One-Way ANOVA, where instead of 8 conditions, we have two conditions, and we average over the 4 groups of the other two factors. For example, for the main effect of size above can be computed analytically. There might be a small difference in the degrees of freedom of the two tests, or it is just random variation (And it will disappear when repeating the simulation 1000.000 times instead of 100.000.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">200</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">8</span>)))
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)

simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                                 <span class="dt">alpha_level =</span> alpha_level, 
                                 <span class="dt">nsims =</span> nsims,
                                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(simulation_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Simulated ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-70">Table 6.1: </span>Simulated ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">effect_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anova_Size</td>
<td align="right">69.81</td>
<td align="right">0.0175917</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result,
                            <span class="dt">alpha_level =</span> alpha_level,
                            <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(exact_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Exact ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-70">Table 6.1: </span>Exact ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size</td>
<td align="right">70.33</td>
<td align="right">0.0155</td>
<td align="right">0.1253</td>
<td align="right">6.25</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power based on analytical solution</span>
<span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power <span class="co">#using default alpha level of .05</span></code></pre>
<pre><code>## [1] 70.33333</code></pre>
<p>Similarly, we can create a 2 factor design where we average over the third factor, and recreate the power analysis for the Two-Way interaction. For example, we can group over the Cognitive Load condition, and look at the Size by Color Interaction:</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b*2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">6</span>)), <span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)))
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)

simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                                 <span class="dt">alpha_level =</span> alpha_level, 
                                 <span class="dt">nsims =</span> nsims,
                                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(simulation_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Simulated ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-71">Table 6.2: </span>Simulated ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">effect_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anova_Size</td>
<td align="right">70.31</td>
<td align="right">0.0179285</td>
</tr>
<tr class="even">
<td>anova_Color</td>
<td align="right">4.81</td>
<td align="right">0.0025461</td>
</tr>
<tr class="odd">
<td>anova_Size:Color</td>
<td align="right">70.49</td>
<td align="right">0.0180566</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result,
                            <span class="dt">alpha_level =</span> alpha_level,
                            <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(exact_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Exact ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-71">Table 6.2: </span>Exact ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size</td>
<td align="right">70.33</td>
<td align="right">0.0155</td>
<td align="right">0.1256</td>
<td align="right">6.25</td>
</tr>
<tr class="even">
<td>Color</td>
<td align="right">5.00</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td>Size:Color</td>
<td align="right">70.33</td>
<td align="right">0.0155</td>
<td align="right">0.1256</td>
<td align="right">6.25</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power based on analytical solution</span>
power_res &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result) <span class="co">#using default alpha level of .05</span>
power_res<span class="op">$</span>power_A</code></pre>
<pre><code>## [1] 70.33228</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_res<span class="op">$</span>power_B</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_res<span class="op">$</span>power_AB</code></pre>
<pre><code>## [1] 70.33228</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b*2b*2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>) 
sd &lt;-<span class="st"> </span><span class="dv">10</span>
r &lt;-<span class="st"> </span><span class="fl">0.0</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;big&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, 
                <span class="st">&quot;CognitiveLoad&quot;</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>) <span class="co">#</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)

simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                                 <span class="dt">alpha_level =</span> alpha_level, 
                                 <span class="dt">nsims =</span> nsims,
                                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(simulation_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Simulated ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-72">Table 6.3: </span>Simulated ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">effect_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anova_Size</td>
<td align="right">40.55</td>
<td align="right">0.0100946</td>
</tr>
<tr class="even">
<td>anova_Color</td>
<td align="right">6.13</td>
<td align="right">0.0028038</td>
</tr>
<tr class="odd">
<td>anova_CognitiveLoad</td>
<td align="right">11.37</td>
<td align="right">0.0039782</td>
</tr>
<tr class="even">
<td>anova_Size:Color</td>
<td align="right">6.21</td>
<td align="right">0.0027657</td>
</tr>
<tr class="odd">
<td>anova_Size:CognitiveLoad</td>
<td align="right">5.52</td>
<td align="right">0.0026989</td>
</tr>
<tr class="even">
<td>anova_Color:CognitiveLoad</td>
<td align="right">5.54</td>
<td align="right">0.0026196</td>
</tr>
<tr class="odd">
<td>anova_Size:Color:CognitiveLoad</td>
<td align="right">77.94</td>
<td align="right">0.0211241</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result,
                            <span class="dt">alpha_level =</span> alpha_level,
                            <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(exact_result<span class="op">$</span>main_results,
             <span class="dt">caption =</span> <span class="st">&quot;Exact ANOVA Result&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-72">Table 6.3: </span>Exact ANOVA Result</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">power</th>
<th align="right">partial_eta_squared</th>
<th align="right">cohen_f</th>
<th align="right">non_centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size</td>
<td align="right">41.53</td>
<td align="right">0.0078</td>
<td align="right">0.0884</td>
<td align="right">3.0625</td>
</tr>
<tr class="even">
<td>Color</td>
<td align="right">5.72</td>
<td align="right">0.0002</td>
<td align="right">0.0126</td>
<td align="right">0.0625</td>
</tr>
<tr class="odd">
<td>CognitiveLoad</td>
<td align="right">11.62</td>
<td align="right">0.0014</td>
<td align="right">0.0379</td>
<td align="right">0.5625</td>
</tr>
<tr class="even">
<td>Size:Color</td>
<td align="right">5.72</td>
<td align="right">0.0002</td>
<td align="right">0.0126</td>
<td align="right">0.0625</td>
</tr>
<tr class="odd">
<td>Size:CognitiveLoad</td>
<td align="right">5.72</td>
<td align="right">0.0002</td>
<td align="right">0.0126</td>
<td align="right">0.0625</td>
</tr>
<tr class="even">
<td>Color:CognitiveLoad</td>
<td align="right">5.72</td>
<td align="right">0.0002</td>
<td align="right">0.0126</td>
<td align="right">0.0625</td>
</tr>
<tr class="odd">
<td>Size:Color:CognitiveLoad</td>
<td align="right">78.33</td>
<td align="right">0.0189</td>
<td align="right">0.1389</td>
<td align="right">7.5625</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analytical power calculation</span>
power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)
power_analytic<span class="op">$</span>power_A</code></pre>
<pre><code>## [1] 41.5306</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_B</code></pre>
<pre><code>## [1] 5.715533</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_C</code></pre>
<pre><code>## [1] 11.61827</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AB</code></pre>
<pre><code>## [1] 5.715533</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AC</code></pre>
<pre><code>## [1] 5.715533</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_BC</code></pre>
<pre><code>## [1] 5.715533</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_ABC</code></pre>
<pre><code>## [1] 78.33036</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</code></pre>
<pre><code>## [1] 0.007598077</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_B</code></pre>
<pre><code>## [1] 0.0001562256</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_C</code></pre>
<pre><code>## [1] 0.001404275</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AB</code></pre>
<pre><code>## [1] 0.0001562256</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_AC</code></pre>
<pre><code>## [1] 0.0001562256</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_BC</code></pre>
<pre><code>## [1] 0.0001562256</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_ABC</code></pre>
<pre><code>## [1] 0.01855544</code></pre>
<p>The power for interactions depends on Cohen’s <em>f</em>, the alpha level, the sample size, and the degrees of freedom.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># With 2x2x2 designs, the names for paired comparisons can become very long. </span>
<span class="co"># So here the sample size abbreviate terms</span>
<span class="co"># Size, Color, and Cognitive Load, have values:</span>
<span class="co"># b = big, s = small, g = green, r = red, pres = present, abs = absent.  </span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>, 
                <span class="st">&quot;Load&quot;</span>, <span class="st">&quot;pres&quot;</span>, <span class="st">&quot;abs&quot;</span>) <span class="co">#</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;3b*2b*2b&quot;</span>, <span class="co">#describe the design</span>
                              <span class="dt">n =</span> <span class="dv">15</span>, <span class="co">#sample size per group </span>
                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">20</span>), 
                              
                              <span class="dt">sd =</span> <span class="dv">20</span>, <span class="co">#</span>
                              <span class="dt">labelnames =</span> labelnames) 

<span class="co"># Power based on exact simulations</span>
exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power partial_eta_squared cohen_f non_centrality
## Size            26.93              0.0147  0.1220            2.5
## Color            5.00              0.0000  0.0000            0.0
## Load             5.00              0.0000  0.0000            0.0
## Size:Color      67.93              0.0427  0.2113            7.5
## Size:Load       67.93              0.0427  0.2113            7.5
## Color:Load      60.39              0.0289  0.1725            5.0
## Size:Color:Load 26.93              0.0147  0.1220            2.5
## 
## Power and Effect sizes for contrasts
##                                                     power effect_size
## p_Size_b_Color_g_Load_pres_Size_b_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_b_Color_r_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_s_Color_r_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_g_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_g_Load_abs  75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_r_Load_pres 75.29          -1
## p_Size_b_Color_g_Load_pres_Size_x_Color_r_Load_abs   5.00           0
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_b_Color_r_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_g_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_b_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_b_Color_r_Load_pres_Size_b_Color_r_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_g_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_b_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_g_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_b_Color_r_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_s_Color_g_Load_pres_Size_s_Color_g_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_s_Color_g_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_s_Color_r_Load_abs    5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_s_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_s_Color_r_Load_pres_Size_s_Color_r_Load_abs   5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_g_Load_pres  5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_s_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_s_Color_r_Load_abs_Size_x_Color_g_Load_pres   5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_g_Load_abs    5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_s_Color_r_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_x_Color_g_Load_pres_Size_x_Color_g_Load_abs   5.00           0
## p_Size_x_Color_g_Load_pres_Size_x_Color_r_Load_pres  5.00           0
## p_Size_x_Color_g_Load_pres_Size_x_Color_r_Load_abs  75.29           1
## p_Size_x_Color_g_Load_abs_Size_x_Color_r_Load_pres   5.00           0
## p_Size_x_Color_g_Load_abs_Size_x_Color_r_Load_abs   75.29           1
## p_Size_x_Color_r_Load_pres_Size_x_Color_r_Load_abs  75.29           1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analytical power calculation</span>
power_analytic &lt;-<span class="st"> </span><span class="kw">power_threeway_between</span>(design_result)
power_analytic<span class="op">$</span>power_A</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_B</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_C</code></pre>
<pre><code>## [1] 48.6496</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AB</code></pre>
<pre><code>## [1] 34.7961</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_AC</code></pre>
<pre><code>## [1] 67.97466</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_BC</code></pre>
<pre><code>## [1] 91.55713</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>power_ABC</code></pre>
<pre><code>## [1] NaN</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>Cohen_f_A</code></pre>
<pre><code>## [1] 0</code></pre>
<p>We see that a pattern of means of 0, 0, 0, 0, 0, 0, 0, 20 for a 2x2x2 interaction equals a Cohen’s f of 0.25.</p>
<pre class="sourceCode r"><code class="sourceCode r">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;Color&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;r&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b*2b&quot;</span>, <span class="co">#describe the design</span>
                              <span class="dt">n =</span> <span class="dv">10</span>, <span class="co">#sample size per group </span>
                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="co">#pattern of means</span>
                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span>
                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span>

<span class="co"># Power based on exact simulations</span>
exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##            power partial_eta_squared cohen_f non_centrality
## Size       33.71              0.0649  0.2635            2.5
## Color      33.71              0.0649  0.2635            2.5
## Size:Color 33.71              0.0649  0.2635            2.5
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_Size_b_Color_g_Size_b_Color_r   5.0           0
## p_Size_b_Color_g_Size_s_Color_g   5.0           0
## p_Size_b_Color_g_Size_s_Color_r  56.2           1
## p_Size_b_Color_r_Size_s_Color_g   5.0           0
## p_Size_b_Color_r_Size_s_Color_r  56.2           1
## p_Size_s_Color_g_Size_s_Color_r  56.2           1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analytical power calculation</span>
power_analytic &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result)
power_analytic<span class="op">$</span>power_A</code></pre>
<pre><code>## [1] 33.71329</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span>_A</code></pre>
<pre><code>## [1] 0.05882353</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>Cohen_f_A</code></pre>
<pre><code>## [1] 0.25</code></pre>
<p>Cohen’s f is twice as large for a 2x2 design with the same mean value in one of four cells. In a 2 factor between design.</p>
<pre class="sourceCode r"><code class="sourceCode r">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Size&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;s&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> <span class="st">&quot;2b&quot;</span>, <span class="co">#describe the design</span>
                              <span class="dt">n =</span> <span class="dv">10</span>, <span class="co">#sample size per group </span>
                              <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="co">#pattern of means</span>
                              <span class="dt">sd =</span> <span class="dv">10</span>, <span class="co">#standard deviation</span>
                              <span class="dt">labelnames =</span> labelnames) <span class="co">#names of labels</span>

<span class="co"># Power based on exact simulations</span>
exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##      power partial_eta_squared cohen_f non_centrality
## Size 18.51              0.0649  0.2635           1.25
## 
## Power and Effect sizes for contrasts
##                 power effect_size
## p_Size_b_Size_s 18.51         0.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Analytical power calculation</span>
power_analytic &lt;-<span class="st"> </span><span class="kw">power_oneway_between</span>(design_result)
power_analytic<span class="op">$</span>power</code></pre>
<pre><code>## [1] 18.50957</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.05882353</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">power_analytic<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.25</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixed-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-for-interactions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
