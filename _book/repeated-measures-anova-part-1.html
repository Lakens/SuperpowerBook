<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Repeated Measures-ANOVA Part 1 | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Repeated Measures-ANOVA Part 1 | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Repeated Measures-ANOVA Part 1 | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-way-anova-part-2.html"/>
<link rel="next" href="repeated-measures-anova-part-2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#validation-of-power-in-one-way-anova"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#two-conditions"><i class="fa fa-check"></i><b>2.2</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#validation-of-power-in-one-way-anova-with-brysbaert-example"><i class="fa fa-check"></i><b>3.1</b> Validation of Power in One-Way ANOVA with Brysbaert example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Three conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2</b> Power for simple effects</a></li>
<li class="chapter" data-level="3.3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#one-way-anova-part-3"><i class="fa fa-check"></i><b>3.3</b> One-way ANOVA Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication"><i class="fa fa-check"></i><b>3.4</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.5" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#variation-1"><i class="fa fa-check"></i><b>3.5</b> Variation 1</a></li>
<li class="chapter" data-level="3.6" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>3.6</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.7" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#variation-2"><i class="fa fa-check"></i><b>3.7</b> Variation 2</a></li>
<li class="chapter" data-level="3.8" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>3.8</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures-ANOVA Part 1</a><ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>5.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="5.2" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>5.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html"><i class="fa fa-check"></i><b>6</b> Repeated Measures-ANOVA Part 3</a><ul>
<li class="chapter" data-level="6.1" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>6.1</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="6.2" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>6.2</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="repeated-measures-anova-part-1" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Repeated Measures-ANOVA Part 1</h1>
<p>In a repeated measures design multiple observations are collected from the same participants. In the simplest case, where there are two repeated observations, a repeated measures ANOVA equals a dependent or paired <em>t</em>-test. The difference compared to a between subject design is that repeated measures can be correlated, and in psychology, they often are. Let’s first explore the impact of this correlation on the power of a repeated measures ANOVA.</p>
<div id="two-conditions-medium-effect-size" class="section level2">
<h2><span class="header-section-number">4.1</span> Two conditions, medium effect size</h2>
<p>To illustrate the effect of correated observations, we start by simulating data for a medium effect size for a dependent (or paired, or within-subject) <em>t</em>-test. Let’s first look at G*power. If we want to perform an a-priori power analysis, we are asked to fill in the effect size dz. As Cohen (1988) writes, “The Z subscript is used to emphasize the fact that our raw score unit is no longer X or Y, but Z”, where Z are the difference scores of X-Y.</p>
<p><img src="screenshots/gpower_9.png" /></p>
<p>Within designs can have greater power to detect differences than between designs because the values are correlated, and a within design requires less participants because each participant provides multiple observations. One difference between an independent <em>t</em>-test and a dependent <em>t</em>-test is that an independent <em>t</em>-test has 2(n-1) degrees of freedom, while a dependent <em>t</em>-test has (n-1) degrees of freedom. The sample size needed in a two-group within-design (NW) relative to the sample needed in two-group between-designs (NB), assuming normal distributions, and ignoring the difference in degrees of freedom between the two types of tests, is (from Maxwell &amp; Delaney, 2004, p. 561, formula 45):</p>
<p><span class="math inline">\(N_{W}=\frac{N_{B}(1-\rho)}{2}\)</span></p>
<p>The division by 2 in the equation is due to the fact that in a two-condition within design every participant provides two data-points. The extent to which this reduces the sample size compared to a between-subject design depends on the correlation (<em>r</em>) between the two dependent variables, as indicated by the 1-r part of the equation. If the correlation is 0, a within-subject design needs half as many participants as a between-subject design (e.g., 64 instead 128 participants), simply because every participants provides 2 datapoints. The higher the correlation, the larger the relative benefit of within designs, and whenever the correlation is negative (up to -1) the relative benefit disappears.</p>
<p>Whereas in an independent <em>t</em>-test the two observations are uncorrelated, in a within design the observations are correlated. This has an effect on the standard deviation of the difference scores. In turn, because the standardized effect size is the mean difference divided by the standard deviation of the difference scores, the correlation has an effect on the standardized mean difference in a within design, Cohen’s dz. The relation, as Cohen (1988, formula 2.3.7) explains, is:</p>
<p><span class="math inline">\(\sigma_{z}=\sigma\sqrt{2(1-\rho)}\)</span></p>
<p>Therefore, the relation between dz and d is <span class="math inline">\(\sqrt{2(1-\rho)}\)</span>. As Cohen (1988) writes: "In other words, a given difference between population means for matched (dependent) samples is standardized by a value which is <span class="math inline">\(\sqrt{2(1-\rho)}\)</span> as large as would be the case were they independent. If we enter a correlation of 0.5 in the formula, we get <span class="math inline">\(\sqrt{2(0.5)}=1\)</span>. In other words, when the correlation is 0.5, d = dz. When there is a strong correlation between dependent variables, for example r = 0.9, we get <span class="math inline">\(d=d_{z}\sqrt{2(1-0.9)}\)</span>, and a dz of 1 would be a d = 0.45. Reversely, <span class="math inline">\(d_{z}=\frac{d}{\sqrt{2(1-r)}}\)</span>, so with a r = 0.9, a d of 1 would be a dz = 2.24. Some consider this increase in dz compared to d when observations are strongly correlated an ‘inflation’ when estimating effect sizes, but since the reduction in the standard deviation of the difference scores due to the correlation makes it easier to distinguish signal from noise in a hypothesis test, it leads to a clear power benefit.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="co"># Check sample size formula Maxwell</span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="co"># Power is pretty similar with n/2, same d (assuming r = 0.5). </span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="co"># Small differences due to df = 2(n-1) vs df = n-1</span></a>
<a class="sourceLine" id="cb116-4" title="4"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb116-5" title="5">           <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">2000</span>, <span class="dv">4000</span>, <span class="dv">8000</span>),</a>
<a class="sourceLine" id="cb116-6" title="6">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb116-7" title="7">           <span class="dt">type =</span> <span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb116-8" title="8">           <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 2000, 4000, 8000
##               d = 0.05
##       sig.level = 0.05
##           power = 0.3524674, 0.6086764, 0.8853424
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb118-2" title="2">           <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>),</a>
<a class="sourceLine" id="cb118-3" title="3">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb118-4" title="4">           <span class="dt">type =</span> <span class="st">&quot;paired&quot;</span>,</a>
<a class="sourceLine" id="cb118-5" title="5">           <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 1000, 2000, 4000
##               d = 0.05
##       sig.level = 0.05
##           power = 0.3520450, 0.6083669, 0.8852320
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>There is no equivalent fz for Cohen’s f for a within subject ANOVA. For two groups, we can directly compute Cohen’s f from Cohen’s d for two groups, as Cohen (1988) describes, because f = 1/2d. For a d = 0.5, f = 0.25. In Gpower we can run a 2 group within-subject power analysis for ANOVA. We plan for 80% power, and reproduce the anaysis above for the dependent <em>t</em>-test. This works because the correlation is set to 0.5, when d = dz, and thus the transformation of f=1/2d works.</p>
<p><img src="screenshots/gpower_1.png" /></p>
<p>If we change the correlation to 0.7 and keep all other settings the same, the repeated measure a-priori power analysis yields a sample of 21. The correlation increases the power for the test.</p>
<p><img src="screenshots/gpower_11.png" /></p>
<p>To reproduce this analysis in Gpower with a dependent <em>t</em>-test we need to change dz following the formula above, <span class="math inline">\(d_{z}=\frac{0.5}{\sqrt{2(1-0.7)}}\)</span>, which yields dz = 0.6454972. If we enter this value in Gpower for an a-priori power analysis, we get the exact same results (as we should, since an repeated measures ANOVA with 2 groups equals a dependent <em>t</em>-test). This example illustrates that the correlation between dependent variables always factors into a power analysis, both for a dependent <em>t</em>-test, and for a repeated measures ANOVA. Because a dependent <em>t</em>-test uses dz the correlation might be less visible, but given the relation between d and dz, the correlation is always taken into account and can greatly improve power for within designs compared to between designs.</p>
<p><img src="screenshots/gpower_10.png" /></p>
<p>We can perform both these power analyses using simuations as well. We set groups to 2 for the simulation, n = 34 (which should give 80.777 power, according to the g*power program), a correlation among repeated measures of 0.5, and an alpha of 0.05. In this case, we simulate data with means -0.25 and 0.25, and set the sd to 1. This means we have a mean difference of 0.5, and a Cohen’s d of 0.5/1 = 0.5. In the first example, we set the correlation to 0.5, and the result should be 80.77% power, and an effect size estimate of 0.5 for the simple effect. We also calculate partial eta-squared for the ANOVA, which equals <span class="math inline">\(\frac{f^2}{f^2+1}\)</span>, or 0.05882353.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">K &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb120-2" title="2">n &lt;-<span class="st"> </span><span class="dv">34</span></a>
<a class="sourceLine" id="cb120-3" title="3">sd &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb120-4" title="4">r &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb120-5" title="5">alpha =<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb120-6" title="6">f &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb120-7" title="7">f2 &lt;-<span class="st"> </span>f<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb120-8" title="8">ES &lt;-<span class="st"> </span>f2<span class="op">/</span>(f2<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb120-9" title="9">ES</a></code></pre></div>
<pre><code>## [1] 0.05882353</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)</a>
<a class="sourceLine" id="cb122-2" title="2">design =<span class="kw">paste</span>(K,<span class="st">&quot;w&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb122-3" title="3">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;fast&quot;</span>, <span class="st">&quot;slow&quot;</span>)</a>
<a class="sourceLine" id="cb122-4" title="4">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> design,</a>
<a class="sourceLine" id="cb122-5" title="5">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb122-6" title="6">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb122-7" title="7">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb122-8" title="8">                   <span class="dt">r =</span> r, </a>
<a class="sourceLine" id="cb122-9" title="9">                   <span class="dt">labelnames =</span> labelnames)</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##             power effect_size
## anova_speed    78      0.2081
## 
## Power and Effect sizes for contrasts
##                         power effect_size
## p_speed_fast_speed_slow    78      0.4979
## 
## Within-Subject Factors Included: Check MANOVA Results</code></pre>
<p>The results of the simulation are indeed very close to 80.777%. Note that the simulation calculates Cohen’s dz effect sizes for paired comparisons - which here given the correlation of 0.5 is also 0.5 for a medium effect size.</p>
<p>We should see a larger dz if we increase the correlation, keeping the sample size the same, following the example in Gpower above. We repeat the simulation, and the only difference is a correlation between dependent variables of 0.7. This should yield an effect size dz = 0.6454972.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">K &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb125-2" title="2">n &lt;-<span class="st"> </span><span class="dv">21</span></a>
<a class="sourceLine" id="cb125-3" title="3">sd &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb125-4" title="4">r &lt;-<span class="st"> </span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb125-5" title="5">alpha =<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb125-6" title="6">f &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb125-7" title="7">f2 &lt;-<span class="st"> </span>f<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb125-8" title="8">ES &lt;-<span class="st"> </span>f2<span class="op">/</span>(f2<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb125-9" title="9">ES</a></code></pre></div>
<pre><code>## [1] 0.05882353</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)</a>
<a class="sourceLine" id="cb127-2" title="2">design =<span class="st"> </span><span class="kw">paste</span>(K,<span class="st">&quot;w&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb127-3" title="3">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;fast&quot;</span>, <span class="st">&quot;slow&quot;</span>)</a>
<a class="sourceLine" id="cb127-4" title="4">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> design,</a>
<a class="sourceLine" id="cb127-5" title="5">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb127-6" title="6">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb127-7" title="7">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb127-8" title="8">                   <span class="dt">r =</span> r, </a>
<a class="sourceLine" id="cb127-9" title="9">                   <span class="dt">labelnames =</span> labelnames)</a></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb128-2" title="2">design_result<span class="op">$</span>sigmatrix</a></code></pre></div>
<pre><code>##      fast slow
## fast  1.0  0.7
## slow  0.7  1.0</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##             power effect_size
## anova_speed    81      0.3225
## 
## Power and Effect sizes for contrasts
##                         power effect_size
## p_speed_fast_speed_slow    81      0.6848
## 
## Within-Subject Factors Included: Check MANOVA Results</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co">#relation dz and f for within designs </span></a>
<a class="sourceLine" id="cb132-2" title="2">f &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="fl">0.6454972</span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="co"># Entering this f in G*power, with a correlation of 0.5, yields the same as entering f = 0.25 and correlation = 0.7. </span></a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-way-anova-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures-anova-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
