<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Power for Interactions | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Power for Interactions | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Power for Interactions | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="error-control-in-exploratory-anova.html"/>
<link rel="next" href="analytic-power-functions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#validation-of-power-in-one-way-anova-part-1"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>2.1.1</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-2-brysbaert-example"><i class="fa fa-check"></i><b>2.2</b> One-way ANOVA Part 2: Brysbaert example</a><ul>
<li class="chapter" data-level="2.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Three conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>2.2.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-3"><i class="fa fa-check"></i><b>2.3</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="2.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication"><i class="fa fa-check"></i><b>2.3.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-1"><i class="fa fa-check"></i><b>2.3.2</b> Variation 1</a></li>
<li class="chapter" data-level="2.3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>2.3.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-2"><i class="fa fa-check"></i><b>2.3.4</b> Variation 2</a></li>
<li class="chapter" data-level="2.3.5" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>2.3.5</b> Three conditions replication</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>3</b> Repeated Measures-ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-2"><i class="fa fa-check"></i><b>3.2</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>3.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="3.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-3"><i class="fa fa-check"></i><b>3.3</b> Repeated Measures-ANOVA Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>3.4</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="3.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>3.5</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>4</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="mixed-anova.html"><a href="mixed-anova.html#part-1-two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>4.1</b> Part 1: Two by two ANOVA, within-between design</a><ul>
<li class="chapter" data-level="4.1.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>4.1.1</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mixed-anova.html"><a href="mixed-anova.html#part-2-two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>4.2</b> Part 2: Two by two ANOVA, within-within design</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.2.1</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mixed-anova.html"><a href="mixed-anova.html#part-3-two-by-two-anova-within-design"><i class="fa fa-check"></i><b>4.3</b> Part 3: Two by two ANOVA, within design</a></li>
<li class="chapter" data-level="4.4" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>4.4</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>5</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="6" data-path="power-for-interactions.html"><a href="power-for-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Interactions</a></li>
<li class="chapter" data-level="7" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>7</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>7.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>7.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="7.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>7.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>7.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>8</b> Power Curve</a></li>
<li class="chapter" data-level="9" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>9</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="9.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>9.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="9.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>9.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="9.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>9.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="11" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html"><i class="fa fa-check"></i><b>11</b> Power for Design Variations</a><ul>
<li class="chapter" data-level="11.1" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html#within-designs"><i class="fa fa-check"></i><b>11.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="setting-the-correlation-matrix.html"><a href="setting-the-correlation-matrix.html"><i class="fa fa-check"></i><b>12</b> Setting the Correlation Matrix</a></li>
<li class="chapter" data-level="13" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html"><i class="fa fa-check"></i><b>13</b> Validation of Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="13.1" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>13.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="13.2" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>13.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="13.3" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>13.3</b> Two conditions, large effect size</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-for-interactions" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Power for Interactions</h1>
<p>In the 17th Data Colada blog post titled <a href="http://datacolada.org/17">No-way Interactions</a> Uri Simonsohn discusses how a moderated interaction (the effect is there in one condition, but disappears in another condition) requires at least twice as many subjects per cell as a study that simply aims to show the simple effect. For example, see the plot below. Assume the score on the vertical axis is desire for fruit, as a function of the fruit that is available (an apple or a banana) and how hungry people are (not, or very). We see there is a difference between the participants desire for a banana compared to an apple, but only for participants who are very hungry. The point that is made is that you need twice as many participants in each cell to have power for the interaction, as you need for the simple effect.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb249-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb249-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb249-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb249-5" title="5">sd &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb249-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb249-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb249-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb249-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb249-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb249-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb249-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a></code></pre></div>
<p>We can reproduce the simulations in the Data Colada blog post, using the original code.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="co">#R-Code</span></a>
<a class="sourceLine" id="cb250-2" title="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb250-3" title="3"><span class="co">#Written by Uri Simonsohn, March 2014</span></a>
<a class="sourceLine" id="cb250-4" title="4"><span class="co">#</span></a>
<a class="sourceLine" id="cb250-5" title="5"><span class="co">#</span></a>
<a class="sourceLine" id="cb250-6" title="6"><span class="co">#In DataColada[17] I propose that 2x2 interaction studies need 2x the sample size</span></a>
<a class="sourceLine" id="cb250-7" title="7"><span class="co">#http://datacolada.org/2014/03/10/17-no-way-interactions</span></a>
<a class="sourceLine" id="cb250-8" title="8"><span class="co">#In a companion ,pdf I show the simple math behind it</span></a>
<a class="sourceLine" id="cb250-9" title="9"><span class="co">#</span></a>
<a class="sourceLine" id="cb250-10" title="10"><span class="co">#</span></a>
<a class="sourceLine" id="cb250-11" title="11"><span class="co">#Simulations are often more persuasive than math, so here it goes.</span></a>
<a class="sourceLine" id="cb250-12" title="12"><span class="co">#I run simulations that compute power for 2 and 4 cell design, the latter testing the interaction</span></a>
<a class="sourceLine" id="cb250-13" title="13"><span class="co">###################################################################################################</span></a>
<a class="sourceLine" id="cb250-14" title="14"><span class="co">#Create function that computes power of Studies 1 and 2, where Study 1  has 2 cells and tests a simple effect</span></a>
<a class="sourceLine" id="cb250-15" title="15"><span class="co">#and Study 2 has 4 cells and tests the interaction</span></a>
<a class="sourceLine" id="cb250-16" title="16">  colada17=<span class="cf">function</span>(d1,d2,n1,n2,simtot)</a>
<a class="sourceLine" id="cb250-17" title="17">  {</a>
<a class="sourceLine" id="cb250-18" title="18">  <span class="co">#n1: sample size, per cell, study 1</span></a>
<a class="sourceLine" id="cb250-19" title="19">  <span class="co">#n2: sample size, per cell, study 2</span></a>
<a class="sourceLine" id="cb250-20" title="20">  <span class="co">#d1: simple effect M1-M2</span></a>
<a class="sourceLine" id="cb250-21" title="21">  <span class="co">#d2: moderated effect M3-M4, full elimination of effect implies d2=0</span></a>
<a class="sourceLine" id="cb250-22" title="22">  <span class="co">#simtot: how many simulations to run</span></a>
<a class="sourceLine" id="cb250-23" title="23">  <span class="co">#Here we will store results</span></a>
<a class="sourceLine" id="cb250-24" title="24">      p1=<span class="kw">c</span>()    <span class="co">#p-values for Study 1</span></a>
<a class="sourceLine" id="cb250-25" title="25">      p2=<span class="kw">c</span>()    <span class="co">#p-values for Study 2</span></a>
<a class="sourceLine" id="cb250-26" title="26">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>simtot) {</a>
<a class="sourceLine" id="cb250-27" title="27">    <span class="co">#draw data 4 samples</span></a>
<a class="sourceLine" id="cb250-28" title="28">    y1=<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">max</span>(n1,n2),<span class="dt">mean=</span>d1)</a>
<a class="sourceLine" id="cb250-29" title="29">    y2=<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">max</span>(n1,n2))</a>
<a class="sourceLine" id="cb250-30" title="30">    y3=<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">max</span>(n1,n2),<span class="dt">mean=</span>d2)</a>
<a class="sourceLine" id="cb250-31" title="31">    y4=<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="kw">max</span>(n1,n2))</a>
<a class="sourceLine" id="cb250-32" title="32">    </a>
<a class="sourceLine" id="cb250-33" title="33">    <span class="co">#GET DATA READY FOR ANOVA  </span></a>
<a class="sourceLine" id="cb250-34" title="34">      y=<span class="kw">c</span>(y1,y2,y3,y4)          <span class="co">#the d.v.</span></a>
<a class="sourceLine" id="cb250-35" title="35">      nrep=<span class="kw">rep</span>(n2,<span class="dv">4</span>)          </a>
<a class="sourceLine" id="cb250-36" title="36">      A=<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">times=</span>nrep) </a>
<a class="sourceLine" id="cb250-37" title="37">      B=<span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">times=</span>nrep)</a>
<a class="sourceLine" id="cb250-38" title="38">    </a>
<a class="sourceLine" id="cb250-39" title="39">    <span class="co">#STUDY 1</span></a>
<a class="sourceLine" id="cb250-40" title="40">      p1.k=<span class="kw">t.test</span>(y1[<span class="dv">1</span><span class="op">:</span>n1],y2[<span class="dv">1</span><span class="op">:</span>n1],<span class="dt">var.equal=</span><span class="ot">TRUE</span>)<span class="op">$</span>p.value  <span class="co">#Do a t-test on the first n1 observations</span></a>
<a class="sourceLine" id="cb250-41" title="41">    </a>
<a class="sourceLine" id="cb250-42" title="42">    <span class="co">#STUDY 2</span></a>
<a class="sourceLine" id="cb250-43" title="43">      p2.k=<span class="kw">anova</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>B))[<span class="st">&quot;A:B&quot;</span>, <span class="st">&quot;Pr(&gt;F)&quot;</span>]             <span class="co">#Do anova, keep p-value of the interaction</span></a>
<a class="sourceLine" id="cb250-44" title="44">        </a>
<a class="sourceLine" id="cb250-45" title="45">      <span class="co">#Store the results</span></a>
<a class="sourceLine" id="cb250-46" title="46">      p1=<span class="kw">c</span>(p1,p1.k)</a>
<a class="sourceLine" id="cb250-47" title="47">      p2=<span class="kw">c</span>(p2,p2.k)</a>
<a class="sourceLine" id="cb250-48" title="48">    </a>
<a class="sourceLine" id="cb250-49" title="49">      }</a>
<a class="sourceLine" id="cb250-50" title="50">  </a>
<a class="sourceLine" id="cb250-51" title="51">  <span class="co">#What share off comparisons are significant</span></a>
<a class="sourceLine" id="cb250-52" title="52">    power1=<span class="kw">sum</span>(p1<span class="op">&lt;=</span>.<span class="dv">05</span>)<span class="op">/</span>simtot  <span class="co">#Simple test using estimate of variance from 2 cells only</span></a>
<a class="sourceLine" id="cb250-53" title="53">    power2=<span class="kw">sum</span>(p2<span class="op">&lt;=</span>.<span class="dv">05</span>)<span class="op">/</span>simtot  <span class="co">#Interaction</span></a>
<a class="sourceLine" id="cb250-54" title="54">  </a>
<a class="sourceLine" id="cb250-55" title="55">    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Study 1 is powered to:&quot;</span>,<span class="kw">round</span>(power1,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb250-56" title="56">    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Study 2 is powered to:&quot;</span>,<span class="kw">round</span>(power2,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb250-57" title="57">  </a>
<a class="sourceLine" id="cb250-58" title="58">    }</a>
<a class="sourceLine" id="cb250-59" title="59">    </a>
<a class="sourceLine" id="cb250-60" title="60">    </a>
<a class="sourceLine" id="cb250-61" title="61"><span class="co">#Same power for 2n regardless of n and d</span></a>
<a class="sourceLine" id="cb250-62" title="62">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">20</span>,<span class="dt">n2=</span><span class="dv">40</span>,<span class="dt">d1=</span><span class="dv">1</span>,<span class="dt">d2=</span><span class="dv">0</span>)  </a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.87
## Study 2 is powered to: 0.87</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">50</span>,<span class="dt">n2=</span><span class="dv">100</span>,<span class="dt">d1=</span>.<span class="dv">3</span>,<span class="dt">d2=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.34
## Study 2 is powered to: 0.33</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">150</span>,<span class="dt">n2=</span><span class="dv">300</span>,<span class="dt">d1=</span>.<span class="dv">25</span>,<span class="dt">d2=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.58
## Study 2 is powered to: 0.57</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1"><span class="co">#Need 4n if effect is 70% attenuated</span></a>
<a class="sourceLine" id="cb256-2" title="2">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">25</span>,<span class="dt">n2=</span><span class="dv">100</span>,<span class="dt">d1=</span>.<span class="dv">5</span>, <span class="dt">d2=</span>.<span class="dv">3</span><span class="op">*</span>.<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.42
## Study 2 is powered to: 0.43</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">50</span>,<span class="dt">n2=</span><span class="dv">200</span>,<span class="dt">d1=</span>.<span class="dv">5</span>, <span class="dt">d2=</span>.<span class="dv">3</span><span class="op">*</span>.<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.68
## Study 2 is powered to: 0.68</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1">  <span class="kw">colada17</span>(<span class="dt">simtot=</span><span class="dv">2000</span>, <span class="dt">n1=</span><span class="dv">22</span>,<span class="dt">n2=</span><span class="dv">88</span>,<span class="dt">d1=</span>.<span class="dv">41</span>, <span class="dt">d2=</span>.<span class="dv">3</span><span class="op">*</span>.<span class="dv">41</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.27
## Study 2 is powered to: 0.26</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1"><span class="co">#underpowered if run with the same n</span></a>
<a class="sourceLine" id="cb262-2" title="2"><span class="kw">colada17</span>(<span class="dt">simtot=</span>nsims, <span class="dt">n1=</span><span class="dv">20</span>,<span class="dt">n2=</span><span class="dv">20</span>,<span class="dt">d1=</span><span class="dv">1</span>,<span class="dt">d2=</span><span class="dv">0</span>)  </a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.91
## Study 2 is powered to: 0.64</code></pre>
<p>And we can reproduce the results using the ANOVA_power function.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></a>
<a class="sourceLine" id="cb264-2" title="2">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                    power effect_size
## anova_fruit          100      0.8684
## anova_hunger         100      0.8707
## anova_fruit:hunger   100      0.8695
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry        2
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger         2
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry     100
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger       5
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry   100
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry    100
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry        0.02503
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger        -0.02397
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      10.15490
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger      -0.04715
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    10.29715
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     10.34551</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##              power partial_eta_squared cohen_f non_centrality
## fruit          100              0.8681  2.5649            500
## hunger         100              0.8681  2.5649            500
## fruit:hunger   100              0.8681  2.5649            500
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry        5
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger         5
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry     100
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger       5
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry   100
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry    100
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry              0
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger               0
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry            10
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger             0
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry          10
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry           10</code></pre>
<p>We see we get the same power for the anova_fruit:hunger interaction and for the simple effect p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry as the simulations by Uri Simonsohn in his blog post.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1"><span class="co">#Same power for 2n regardless of n and d</span></a>
<a class="sourceLine" id="cb268-2" title="2"><span class="kw">colada17</span>(<span class="dt">simtot =</span> <span class="dv">10000</span>, <span class="dt">n1 =</span> <span class="dv">20</span>, <span class="dt">n2 =</span> <span class="dv">40</span>, <span class="dt">d1 =</span> <span class="dv">1</span>, <span class="dt">d2 =</span> <span class="dv">0</span>)  </a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.87
## Study 2 is powered to: 0.88</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"><span class="kw">colada17</span>(<span class="dt">simtot =</span> <span class="dv">10000</span>, <span class="dt">n1 =</span> <span class="dv">50</span>, <span class="dt">n2 =</span> <span class="dv">100</span>, <span class="dt">d1 =</span> <span class="fl">.3</span>, <span class="dt">d2 =</span> <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.32
## Study 2 is powered to: 0.33</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"><span class="kw">colada17</span>(<span class="dt">simtot =</span> <span class="dv">10000</span>, <span class="dt">n1 =</span> <span class="dv">150</span>, <span class="dt">n2 =</span> <span class="dv">300</span>, <span class="dt">d1 =</span> <span class="fl">.25</span>, <span class="dt">d2 =</span> <span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.58
## Study 2 is powered to: 0.58</code></pre>
<p>We can also reproduce the last example by adjusting the means and standard deviation. With 150 people, and a Cohen’s d of 0.25 (the difference is 5, the sd 20, so 5/20 = 0.25) we should reproduce the power for the simple effect.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb274-2" title="2">n &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb274-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb274-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb274-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb274-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb274-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb274-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb274-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb274-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb274-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb274-13" title="13">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></a>
<a class="sourceLine" id="cb274-14" title="14">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                    power effect_size
## anova_fruit           24    0.004791
## anova_hunger          28    0.005156
## anova_fruit:hunger    37    0.005890
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry        9
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger         4
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      50
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger       3
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    55
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     53
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry      -0.009799
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger       -0.010420
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      0.229852
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger     -0.001042
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    0.238688
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     0.238996</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##              power partial_eta_squared cohen_f non_centrality
## fruit        33.33              0.0039  0.0627         2.3438
## hunger       33.33              0.0039  0.0627         2.3438
## fruit:hunger 33.33              0.0039  0.0627         2.3438
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry     5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger      5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry   57.85
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger    5.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry 57.85
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry  57.85
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry           0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger            0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry          0.25
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger          0.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry        0.25
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry         0.25</code></pre>
<p>And changing the sample size to 300 should reproduce the power for the interaction in the ANOVA.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb278-2" title="2">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb278-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb278-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb278-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb278-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb278-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb278-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb278-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb278-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb278-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb278-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb278-13" title="13">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></a>
<a class="sourceLine" id="cb278-14" title="14">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                    power effect_size
## anova_fruit           58    0.004816
## anova_hunger          65    0.005399
## anova_fruit:hunger    54    0.004491
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry        5
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger         7
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      87
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger       6
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    93
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     90
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry       0.011922
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger        0.002149
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      0.262732
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger     -0.009929
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    0.250999
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     0.260107</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##              power partial_eta_squared cohen_f non_centrality
## fruit        58.06              0.0039  0.0626         4.6875
## hunger       58.06              0.0039  0.0626         4.6875
## fruit:hunger 58.06              0.0039  0.0626         4.6875
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry     5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger      5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry   86.37
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger    5.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry 86.37
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry  86.37
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry           0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger            0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry          0.25
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger          0.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry        0.25
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry         0.25</code></pre>
<p>Now if we look at the power analysis table for the last simulation, we see that the power for the ANOVA is the same for the main effect of fruit, the main effect of hunger, and the main effect of the interaction. All the effect sizes are equal as well. We can understand why if we look at the means in a 2x2 table:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1">mean_mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(mu, </a>
<a class="sourceLine" id="cb282-2" title="2">                     <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb282-3" title="3">                     <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="co">#Create a mean matrix</span></a>
<a class="sourceLine" id="cb282-4" title="4"><span class="kw">rownames</span>(mean_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb282-5" title="5"><span class="kw">colnames</span>(mean_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>)</a>
<a class="sourceLine" id="cb282-6" title="6">mean_mat</a></code></pre></div>
<pre><code>##        no hunger very hungry
## apple         20          20
## banana        20          25</code></pre>
<p>The first main effect tests the marginal means if we sum over rows, 22.5 vs 20.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="kw">rowMeans</span>(mean_mat)</a></code></pre></div>
<pre><code>##  apple banana 
##   20.0   22.5</code></pre>
<p>The second main effect tests the marginal means over the rows, which is also 22.5 vs 20.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">colMeans</span>(mean_mat)</a></code></pre></div>
<pre><code>##   no hunger very hungry 
##        20.0        22.5</code></pre>
<p>The interaction tests whether the average effect of hunger on liking fruit differs in the presence of bananas. In the presence of bananas the effect of hunger on the desireability of fruit is 5 scalepoints. The average effect (that we get from the marginal means) of hunger on fruit desireability is 2.5 (22.5-20). In other words, the interaction tests whether the difference effect between hunger and no hunger is different in the presence of an apple versus in the presence of a banana.</p>
<p>Mathematically the interaction effect is computed as the difference between a cell mean and the grand mean, the marginal mean in row i and the grand mean, and the marginal mean in column j and grand mean. For example, for the very hungry-banana condition this is 25 (the value in the cell) - (21.25 [the grand mean] + 1.25 [the marginal mean in row 2, 22.5, minus the grand mean of 21.25] + 1.25 [the marginal mean in column 2, 22.5, minus the grand mean of 21.25]). 25 - (21.25 + (22.5-21.25) + (22.5-21.25)) = 1.25.</p>
<p>We can repeat this for every cell, and get for no hunger-apple: 20 - (21.25 + (20-21.25) + (20-21.25)) = 1.25, for very hungry apple: 20 - (21.25 + (22.5-21.25) + (20-21.25)) = 1.25, and no hunger-banana: 20 - (21.25 + (20-21.25) + (22.5-21.25)) = 1.25. These values are used to calculate the sum of squares.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">a1 &lt;-<span class="st"> </span>mean_mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[<span class="dv">1</span>,]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[,<span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)))</a>
<a class="sourceLine" id="cb288-2" title="2">a2 &lt;-<span class="st"> </span>mean_mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[<span class="dv">1</span>,]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[,<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)))</a>
<a class="sourceLine" id="cb288-3" title="3">b1 &lt;-<span class="st"> </span>mean_mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[<span class="dv">2</span>,]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[,<span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)))</a>
<a class="sourceLine" id="cb288-4" title="4">b2 &lt;-<span class="st"> </span>mean_mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[<span class="dv">2</span>,]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)) <span class="op">+</span><span class="st"> </span>(<span class="kw">mean</span>(mean_mat[,<span class="dv">2</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mean_mat)))</a>
<a class="sourceLine" id="cb288-5" title="5">SS_ab &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">c</span>(a1, a2, b1, b2)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<p>The sum of squares is dependent on the sample size, as can be seen in the code above. The larger the sample size, the larger the sum of squares, and therefore (all else equal) the larger the <em>F</em>-statistic, and the smaller the <em>p</em>-value. We see from the simulations that all three tests have the same effect size, and therefore the same power.</p>
<p>Interactions can have more power than main effects if the effect size of the interaction is larger than the effect size of the main effects. An example of this is a cross-over interaction. For example, let’s take a 2x2 matrix of means with a crossover interaction:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb289-2" title="2">mean_mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(mu, </a>
<a class="sourceLine" id="cb289-3" title="3">                     <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb289-4" title="4">                     <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="co">#Create a mean matrix</span></a>
<a class="sourceLine" id="cb289-5" title="5"><span class="kw">rownames</span>(mean_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb289-6" title="6"><span class="kw">colnames</span>(mean_mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>)</a>
<a class="sourceLine" id="cb289-7" title="7">mean_mat</a></code></pre></div>
<pre><code>##        no hunger very hungry
## apple         25          20
## banana        20          25</code></pre>
<p>Neither of the main effects is now significant, as the marginal means are 22.5 vs 22.5 for both main effects. The interaction is much stronger, however. We are testing whether the average effect of hunger on the desireability of fruit is different in the presence of bananas. Since the average effect is 0, and the effect of hunger on the desireability of bananas is 5, so the effect size is now twice as large.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb291-2" title="2">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb291-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb291-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb291-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb291-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb291-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb291-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb291-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb291-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb291-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb291-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb291-13" title="13">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></a>
<a class="sourceLine" id="cb291-14" title="14">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> alpha_level, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                    power effect_size
## anova_fruit            5   0.0010207
## anova_hunger           8   0.0009135
## anova_fruit:hunger    99   0.0167995
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry       86
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger        86
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry      11
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger       4
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry    92
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry     88
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry     -0.2605675
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger      -0.2603610
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry    -0.0111086
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger    -0.0002042
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry   0.2506972
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry    0.2502920</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##              power partial_eta_squared cohen_f non_centrality
## fruit          5.0              0.0000  0.0000           0.00
## hunger         5.0              0.0000  0.0000           0.00
## fruit:hunger  99.1              0.0154  0.1252          18.75
## 
## Power and Effect sizes for contrasts
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry    86.37
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger     86.37
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry    5.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger    5.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry 86.37
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry  86.37
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry          -0.25
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger           -0.25
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry          0.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger          0.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry        0.25
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry         0.25</code></pre>
<p>We can also reproduce the power analysis using the anlytic function:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">power_analytic &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result)</a>
<a class="sourceLine" id="cb295-2" title="2">power_analytic<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1">power_analytic<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="error-control-in-exploratory-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analytic-power-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
