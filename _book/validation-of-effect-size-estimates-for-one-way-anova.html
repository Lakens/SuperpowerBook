<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Validation of effect size estimates for One-Way ANOVA | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Validation of effect size estimates for One-Way ANOVA | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Validation of effect size estimates for One-Way ANOVA | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="setting-the-correlation-matrix.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#validation-of-power-in-one-way-anova"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#two-conditions"><i class="fa fa-check"></i><b>2.2</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#validation-of-power-in-one-way-anova-with-brysbaert-example"><i class="fa fa-check"></i><b>3.1</b> Validation of Power in One-Way ANOVA with Brysbaert example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Three conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html"><i class="fa fa-check"></i><b>4</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="4.1" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication"><i class="fa fa-check"></i><b>4.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.2" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-1"><i class="fa fa-check"></i><b>4.2</b> Variation 1</a></li>
<li class="chapter" data-level="4.3" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>4.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-2"><i class="fa fa-check"></i><b>4.4</b> Variation 2</a></li>
<li class="chapter" data-level="4.5" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>4.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures-ANOVA Part 1</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>5.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html"><i class="fa fa-check"></i><b>6</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="6.1" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>6.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="6.2" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>6.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html"><i class="fa fa-check"></i><b>7</b> Repeated Measures-ANOVA Part 3</a><ul>
<li class="chapter" data-level="7.1" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>7.1</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="7.2" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>7.2</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html"><i class="fa fa-check"></i><b>8</b> Mixed ANOVA Part 1</a><ul>
<li class="chapter" data-level="8.1" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>8.1</b> Two by two ANOVA, within-between design</a></li>
<li class="chapter" data-level="8.2" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>8.2</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html"><i class="fa fa-check"></i><b>9</b> Mixed ANOVA Part 2</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>9.1</b> Two by two ANOVA, within-within design</a></li>
<li class="chapter" data-level="9.2" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>9.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html"><i class="fa fa-check"></i><b>10</b> Mixed ANOVA Part 3</a><ul>
<li class="chapter" data-level="10.1" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>10.1</b> Two by two ANOVA, within design</a></li>
<li class="chapter" data-level="10.2" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>10.2</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>11</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="12" data-path="power-in-interactions.html"><a href="power-in-interactions.html"><i class="fa fa-check"></i><b>12</b> Power in Interactions</a></li>
<li class="chapter" data-level="13" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>13</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>13.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>13.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="13.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>13.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="13.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design-1"><i class="fa fa-check"></i><b>13.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-curves.html"><a href="power-curves.html"><i class="fa fa-check"></i><b>14</b> Power curves</a></li>
<li class="chapter" data-level="15" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>15</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="15.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>15.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="15.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>15.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="15.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>15.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>16</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="17" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html"><i class="fa fa-check"></i><b>17</b> Power for Design Variations</a><ul>
<li class="chapter" data-level="17.1" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html#within-designs"><i class="fa fa-check"></i><b>17.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="setting-the-correlation-matrix.html"><a href="setting-the-correlation-matrix.html"><i class="fa fa-check"></i><b>18</b> Setting the Correlation Matrix</a></li>
<li class="chapter" data-level="19" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html"><i class="fa fa-check"></i><b>19</b> Validation of effect size estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="19.1" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>19.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="19.2" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>19.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="19.3" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>19.3</b> Two conditions, large effect size</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="validation-of-effect-size-estimates-for-one-way-anova" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Validation of effect size estimates for One-Way ANOVA</h1>
<p>Using the formulas below, we can calculate the means for between designs with one factor (One-Way ANOVA). Using the formula also used in Albers &amp; Lakens (2018), we can determine the means that should yield a specified effect sizes (expressed in Cohen’s f).</p>
<pre class="sourceCode r"><code class="sourceCode r">mu_from_ES &lt;-<span class="st"> </span><span class="cf">function</span>(K, ES){ <span class="co"># provides the vector of population means for a given population ES and nr of groups</span>
  f2 &lt;-<span class="st"> </span>ES <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ES)
  <span class="cf">if</span> (K <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) {
  a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(f2)
  muvec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>a, a)
  }
  <span class="cf">if</span> (K <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {
  a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>f2 <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)
  muvec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>a, <span class="dv">0</span>, a)
  }
  <span class="cf">if</span> (K <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) {
  a &lt;-<span class="st"> </span><span class="kw">sqrt</span>(f2)
  muvec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>a,<span class="op">-</span>a, a, a)
  } <span class="co"># note: function gives error when K not 2,3,4. But we don&#39;t need other K.</span>
  <span class="kw">return</span>(muvec)
}</code></pre>
<p>Eta-squared (idential to partial eta-squared for One-Way ANOVA’s) has benchmarks of .0099, .0588, and .1379 for small, medium, and large effect sizes (cohen, 1988).</p>
<div id="three-conditions-small-effect-size" class="section level2">
<h2><span class="header-section-number">19.1</span> Three conditions, small effect size</h2>
<p>We can simulate a one-factor anova setting means to achieve a certain effect size. Eta-squared is biased. Thus, the eta-squared we calculate based on the observed data overestimates the population effect size. This bias is largest for smaller sample sizes. Thus, to test whether the simulation yields the expected effect size, we use extremele large sample sizes in each between subject condition (n = 5000). This simulation should yield a small effect size (0.099)</p>
<pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="dv">3</span>
ES &lt;-<span class="st"> </span><span class="fl">.0099</span>
mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
sd &lt;-<span class="st"> </span><span class="dv">1</span>
r &lt;-<span class="st"> </span><span class="dv">0</span>
string =<span class="st"> </span><span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">r =</span> r, 
                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>))</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1   100     0.01002
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2   100      0.1220
## p_factor1_level1_factor1_level3   100      0.2446
## p_factor1_level2_factor1_level3   100      0.1231</code></pre>
<p>The resulting effect size estimate from the simulation is very close to 0.0099</p>
</div>
<div id="four-conditions-medium-effect-size" class="section level2">
<h2><span class="header-section-number">19.2</span> Four conditions, medium effect size</h2>
<p>This simulation should yield a medium effect size (0.588) across four independent conditions.</p>
<pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="dv">4</span>
ES &lt;-<span class="st"> </span><span class="fl">.0588</span>
mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
sd &lt;-<span class="st"> </span><span class="dv">1</span>
r &lt;-<span class="st"> </span><span class="dv">0</span>
string =<span class="st"> </span><span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">r =</span> r, 
                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>, <span class="st">&quot;level4&quot;</span>))</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1   100     0.05901
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2     8   0.0021498
## p_factor1_level1_factor1_level3   100   0.5017615
## p_factor1_level1_factor1_level4   100   0.5013550
## p_factor1_level2_factor1_level3   100   0.4991643
## p_factor1_level2_factor1_level4   100   0.4987678
## p_factor1_level3_factor1_level4     5  -0.0006133</code></pre>
<p>Results are very close to 0.588.</p>
</div>
<div id="two-conditions-large-effect-size" class="section level2">
<h2><span class="header-section-number">19.3</span> Two conditions, large effect size</h2>
<p>We can simulate a one-factor anova that should yield a large effect size (0.1379) across two conditions.</p>
<pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="dv">2</span>
ES &lt;-<span class="st"> </span><span class="fl">.1379</span>
mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
sd &lt;-<span class="st"> </span><span class="dv">1</span>
r &lt;-<span class="st"> </span><span class="dv">0</span>
string =<span class="st"> </span><span class="kw">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">r =</span> r, 
                   <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>))</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##               power effect_size
## anova_factor1   100      0.1369
## 
## Power and Effect sizes for contrasts
##                                 power effect_size
## p_factor1_level1_factor1_level2   100      0.7963</code></pre>
<p>The results are very close to is simulation should yield a small effect size (0.1379).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="setting-the-correlation-matrix.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
