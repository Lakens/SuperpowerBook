<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Repeated Measures-ANOVA Part 2 | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Repeated Measures-ANOVA Part 2 | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Repeated Measures-ANOVA Part 2 | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="repeated-measures-anova-part-1.html">
<link rel="next" href="repeated-measures-anova-part-3.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#validation-of-power-in-one-way-anova"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#two-conditions"><i class="fa fa-check"></i><b>2.2</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#validation-of-power-in-one-way-anova-with-brysbaert-example"><i class="fa fa-check"></i><b>3.1</b> Validation of Power in One-Way ANOVA with Brysbaert example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Three conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html"><i class="fa fa-check"></i><b>4</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="4.1" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication"><i class="fa fa-check"></i><b>4.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.2" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-1"><i class="fa fa-check"></i><b>4.2</b> Variation 1</a></li>
<li class="chapter" data-level="4.3" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>4.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-2"><i class="fa fa-check"></i><b>4.4</b> Variation 2</a></li>
<li class="chapter" data-level="4.5" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>4.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures-ANOVA Part 1</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>5.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html"><i class="fa fa-check"></i><b>6</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="6.1" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>6.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="6.2" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>6.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html"><i class="fa fa-check"></i><b>7</b> Repeated Measures-ANOVA Part 3</a><ul>
<li class="chapter" data-level="7.1" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>7.1</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="7.2" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>7.2</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html"><i class="fa fa-check"></i><b>8</b> Mixed ANOVA Part 1</a><ul>
<li class="chapter" data-level="8.1" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>8.1</b> Two by two ANOVA, within-between design</a></li>
<li class="chapter" data-level="8.2" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>8.2</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html"><i class="fa fa-check"></i><b>9</b> Mixed ANOVA Part 2</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>9.1</b> Two by two ANOVA, within-within design</a></li>
<li class="chapter" data-level="9.2" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>9.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html"><i class="fa fa-check"></i><b>10</b> Mixed ANOVA Part 3</a><ul>
<li class="chapter" data-level="10.1" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>10.1</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="simple-example-2x2-within-design.html"><a href="simple-example-2x2-within-design.html"><i class="fa fa-check"></i><b>11</b> Simple example: 2x2 within design</a></li>
<li class="chapter" data-level="12" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>12</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="13" data-path="power-in-interactions.html"><a href="power-in-interactions.html"><i class="fa fa-check"></i><b>13</b> Power in Interactions</a></li>
<li class="chapter" data-level="14" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>14</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="14.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>14.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="14.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>14.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="14.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>14.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="14.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design-1"><i class="fa fa-check"></i><b>14.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="power-curves.html"><a href="power-curves.html"><i class="fa fa-check"></i><b>15</b> Power curves</a></li>
<li class="chapter" data-level="16" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>16</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="16.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>16.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="16.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>16.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="16.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>16.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="repeated-measures-anova-part-2" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Repeated Measures-ANOVA Part 2</h1>
<p>In a repeated measures design multiple observations are collected from the same participants. Here, we will examine a repeated measures experiment with 3 within-subject conditions, to illustrate how a repeated measures ANOVA extends a dependent <em>t</em>-test with 3 groups.</p>
<p>In the example for a two-group within design we provided a specific formula for the sample size benefit for two groups. The sample size needed in within-designs (NW) with more than 2 conditions, relative to the sample needed in between-designs (NB), assuming normal distributions and compound symmetry, and ignoring the difference in degrees of freedom between the two types of tests, is (from Maxwell &amp; Delaney, 2004, p. 562, formula 47):</p>
<p><span class="math inline">\(N_{W}=\frac{N_{B}(1-\rho)}{a}\)</span></p>
<p>Where a is the number of within-subject levels.</p>
<div id="the-relation-between-cohens-f-and-cohens-d" class="section level2">
<h2><span class="header-section-number">6.1</span> The relation between Cohen’s f and Cohen’s d</h2>
<p>Whereas in the case of a repeated measures ANOVA with 2 groups we could explain the principles of a power analysis by comparing our test against a <em>t</em>-test and Cohen’s d, this becomes more difficult when we have more than 2 groups. It is more useful to explain how to directly calculate Cohen’s f, the effect size used in power analyses for ANOVA. Cohen’s f is calculated following Cohen, 1988, formula 8.2.1 and 8.2.2:</p>
<p><span class="math inline">\(f = \sqrt{\frac{\frac{\sum(\mu-\overline{\mu})^2)}N}\sigma}\)</span></p>
<p>Imagine we have a within-subject experiment with 3 conditions. We ask people what they mood is when their alarm clock wakes them up, when they wake up naturally on a week day, and when they wake up naturally on a weekend day. Based on pilot data, we expect the means (on a 7 point validated mood scale) are 3.8, 4.2, and 4.3. The standard deviation is 0.9, and the correlation between the dependent measurements is 0.7. We can calculate Cohen’s f for the ANOVA, and Cohen’s dz for the contrasts:</p>
<pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.8</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span>)
sd &lt;-<span class="st"> </span><span class="fl">0.9</span>
f &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>((mu<span class="op">-</span><span class="kw">mean</span>(mu))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">length</span>(mu))<span class="op">/</span>sd <span class="co">#Cohen, 1988, formula 8.2.1 and 8.2.2</span>
f</code></pre>
<pre><code>## [1] 0.2400274</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">r &lt;-<span class="st"> </span><span class="fl">0.7</span>
(<span class="fl">4.2-3.8</span>)<span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>r))</code></pre>
<pre><code>## [1] 0.5737753</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="fl">4.3-3.8</span>)<span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>r))</code></pre>
<pre><code>## [1] 0.7172191</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="fl">4.3-4.2</span>)<span class="op">/</span><span class="fl">0.9</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>r))</code></pre>
<pre><code>## [1] 0.1434438</code></pre>
<p>The relation between Cohen’s d or dz and Cohen’s f becomes more difficult when there are multiple groups, because the relationship depends on the pattern of the means. Cohen (1988) presents calculations for three patterns, minimal variability (for example, for 5 means: -0.25, 0, 0, 0, 0.25), medium variability (for example, for 5 means: -0.25, -0.25, 0.25, 0.25, 0.25 or -0.25, -0.25, -0.25, 0.25, 0.25). For these three patterns, formula’s are available that compute Cohen’s f from Cohen’s d, where d is the effect size calculated for the difference between the largest and smallest mean (if the largest mean is 0.25 and the smallest mean is -0.25, 0.25 - -0.25 = 0.5, so d is 0.5 divided by the standard deviation of 0.9). In our example, d would be (4.3-3.8)/0.9 = 0.5555556. If we divide this value by sqrt(2*(1-r)) we have dz = 0.5555556/0.7745967 = 0.7172191.</p>
<p>I have created a custom function that will calculate f from d, based on a specification of one of the three patterns of means. Our pattern is most similar (but not identical) to a maximum variability pattern (two means are high, one is lower). So we could attempt to calculate f from d (0.5555556), by calculating d from the largest and smallest mean:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/Lakens/ANOVA_power_simulation/master/calc_f_d_eta.R&quot;</span>)
res &lt;-<span class="st"> </span><span class="kw">calc_f_d_eta</span>(<span class="dt">mu =</span> mu, <span class="dt">sd =</span> sd, <span class="dt">variability =</span> <span class="st">&quot;maximum&quot;</span>)
res<span class="op">$</span>f</code></pre>
<pre><code>## [1] 0.2618914</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">res<span class="op">$</span>d</code></pre>
<pre><code>## [1] 0.5555556</code></pre>
<p>We see the Cohen’s f value is 0.2618914 and d = 0.5555556. The Cohen’s f is not perfectly accurate - it is assuming the pattern of means is 3.8, 4.3, 4.3, and not 3.8, 4.2, 4.3. If the means and sd is known, it is best to calculate Cohen’s f directly from these values.</p>
</div>
<div id="three-within-conditions-medium-effect-size" class="section level2">
<h2><span class="header-section-number">6.2</span> Three within conditions, medium effect size</h2>
<p>We can perform power analyses for within designs using simuations. We set groups to 3 for the simulation, n = 20, and the correlation between dependent variables to 0.8. If the true effect size is f = 0.25, and the alpha level is 0.05, the power is 96.6%.</p>
<p>In this case, we simulate data with means -0.3061862, 0.0000000, and 0.3061862, and set the sd to 1.</p>
<pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="dv">3</span>
n &lt;-<span class="st"> </span><span class="dv">20</span>
sd &lt;-<span class="st"> </span><span class="dv">1</span>
r &lt;-<span class="st"> </span><span class="fl">0.8</span>
alpha =<span class="st"> </span><span class="fl">0.05</span>
f &lt;-<span class="st"> </span><span class="fl">0.25</span>
f2 &lt;-<span class="st"> </span>f<span class="op">^</span><span class="dv">2</span>
ES &lt;-<span class="st"> </span>f2<span class="op">/</span>(f2<span class="op">+</span><span class="dv">1</span>)
ES</code></pre>
<pre><code>## [1] 0.05882353</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)
<span class="kw">sqrt</span>(<span class="kw">sum</span>((mu<span class="op">-</span><span class="kw">mean</span>(mu))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">length</span>(mu))<span class="op">/</span>sd <span class="co">#Cohen, 1988, formula 8.2.1 and 8.2.2</span></code></pre>
<pre><code>## [1] 0.25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">design =<span class="kw">paste</span>(K,<span class="st">&quot;w&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;fast&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;slow&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> design,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">r =</span> r, 
                   <span class="dt">labelnames =</span> labelnames)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span>
<span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##             power effect_size
## anova_speed    97       0.357
## 
## Power and Effect sizes for contrasts
##                           power effect_size
## p_speed_fast_speed_medium    53      0.5245
## p_speed_fast_speed_slow      98      1.0451
## p_speed_medium_speed_slow    57      0.5081
## 
## Within-Subject Factors Included: Check MANOVA Results</code></pre>
<p>The results of the simulation are indeed very close to 96.9%. We can see this is in line with the power estimate from Gpower:</p>
<p><img src="screenshots/gpower_12.png" /></p>
<p>We can also validate this by creating the code to do a power analysis in R from scratch:</p>
<pre class="sourceCode r"><code class="sourceCode r">K &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">#three groups</span>
n &lt;-<span class="st"> </span><span class="dv">20</span>
sd &lt;-<span class="st"> </span><span class="dv">1</span>
r &lt;-<span class="st"> </span><span class="fl">0.8</span>
alpha =<span class="st"> </span><span class="fl">0.05</span>
f &lt;-<span class="st"> </span><span class="fl">0.25</span>
f2 &lt;-<span class="st"> </span>f<span class="op">^</span><span class="dv">2</span>
ES &lt;-<span class="st"> </span>f2<span class="op">/</span>(f2<span class="op">+</span><span class="dv">1</span>)
ES</code></pre>
<pre><code>## [1] 0.05882353</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">mu_from_ES</span>(<span class="dt">K =</span> K, <span class="dt">ES =</span> ES)
design =<span class="kw">paste</span>(K,<span class="st">&quot;w&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;fast&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;slow&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> design,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">r =</span> r, 
                   <span class="dt">labelnames =</span> labelnames)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.9691634</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.05882353</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>eta_p_<span class="dv">2</span>_SPSS</code></pre>
<pre><code>## [1] 0.3303965</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.7024394</code></pre>
<p>We can even check the calculation of Cohen’s f SPSS style in GPower. We take the GPower settings as illustrated above. We click the ‘Options’ button, and check the radiobutton next to ‘As in SPSS’. Click ok, and you will notice that the ‘Corr among rep measures’ field has disappeared. The correlation does not need to be entered seperately, but is incorporated in Cohen’s f. The value of Cohen’s f, which was 0.25, has changed into 0.7024394. This is the SPSS equivalent. The value is much larger. This value, and it’s corresponding partial eta-squared, incorporate the correlation between observations.</p>
<p><img src="screenshots/gpower_14.png" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="repeated-measures-anova-part-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures-anova-part-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
