<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Error Control in Exploratory ANOVA | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Error Control in Exploratory ANOVA | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Error Control in Exploratory ANOVA | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mixed-anova-part-3.html">
<link rel="next" href="power-in-interactions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#validation-of-power-in-one-way-anova"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#two-conditions"><i class="fa fa-check"></i><b>2.2</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#validation-of-power-in-one-way-anova-with-brysbaert-example"><i class="fa fa-check"></i><b>3.1</b> Validation of Power in One-Way ANOVA with Brysbaert example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#three-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Three conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova-part-2.html"><a href="one-way-anova-part-2.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html"><i class="fa fa-check"></i><b>4</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="4.1" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication"><i class="fa fa-check"></i><b>4.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.2" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-1"><i class="fa fa-check"></i><b>4.2</b> Variation 1</a></li>
<li class="chapter" data-level="4.3" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>4.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="4.4" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#variation-2"><i class="fa fa-check"></i><b>4.4</b> Variation 2</a></li>
<li class="chapter" data-level="4.5" data-path="one-way-anova-part-3.html"><a href="one-way-anova-part-3.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>4.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures-ANOVA Part 1</a><ul>
<li class="chapter" data-level="5.1" data-path="repeated-measures-anova-part-1.html"><a href="repeated-measures-anova-part-1.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>5.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html"><i class="fa fa-check"></i><b>6</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="6.1" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>6.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="6.2" data-path="repeated-measures-anova-part-2.html"><a href="repeated-measures-anova-part-2.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>6.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html"><i class="fa fa-check"></i><b>7</b> Repeated Measures-ANOVA Part 3</a><ul>
<li class="chapter" data-level="7.1" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>7.1</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="7.2" data-path="repeated-measures-anova-part-3.html"><a href="repeated-measures-anova-part-3.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>7.2</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html"><i class="fa fa-check"></i><b>8</b> Mixed ANOVA Part 1</a><ul>
<li class="chapter" data-level="8.1" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>8.1</b> Two by two ANOVA, within-between design</a></li>
<li class="chapter" data-level="8.2" data-path="mixed-anova-part-1.html"><a href="mixed-anova-part-1.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>8.2</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html"><i class="fa fa-check"></i><b>9</b> Mixed ANOVA Part 2</a><ul>
<li class="chapter" data-level="9.1" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>9.1</b> Two by two ANOVA, within-within design</a></li>
<li class="chapter" data-level="9.2" data-path="mixed-anova-part-2.html"><a href="mixed-anova-part-2.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>9.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html"><i class="fa fa-check"></i><b>10</b> Mixed ANOVA Part 3</a><ul>
<li class="chapter" data-level="10.1" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>10.1</b> Two by two ANOVA, within design</a></li>
<li class="chapter" data-level="10.2" data-path="mixed-anova-part-3.html"><a href="mixed-anova-part-3.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>10.2</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>11</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="12" data-path="power-in-interactions.html"><a href="power-in-interactions.html"><i class="fa fa-check"></i><b>12</b> Power in Interactions</a></li>
<li class="chapter" data-level="13" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>13</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>13.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="13.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>13.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="13.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>13.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="13.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design-1"><i class="fa fa-check"></i><b>13.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-curves.html"><a href="power-curves.html"><i class="fa fa-check"></i><b>14</b> Power curves</a></li>
<li class="chapter" data-level="15" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>15</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="15.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>15.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="15.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>15.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="15.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>15.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>16</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="17" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html"><i class="fa fa-check"></i><b>17</b> Power for Design Variations</a><ul>
<li class="chapter" data-level="17.1" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html#within-designs"><i class="fa fa-check"></i><b>17.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="setting-the-correlation-matrix.html"><a href="setting-the-correlation-matrix.html"><i class="fa fa-check"></i><b>18</b> Setting the Correlation Matrix</a></li>
<li class="chapter" data-level="19" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html"><i class="fa fa-check"></i><b>19</b> Validation of effect size estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="19.1" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>19.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="19.2" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>19.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="19.3" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>19.3</b> Two conditions, large effect size</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="error-control-in-exploratory-anova" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Error Control in Exploratory ANOVA</h1>
<p>In a 2X2X2 design, an ANOVA will give the test results for three main effects, three two-way interactions, and one three-way interaction. That’s 7 statistical tests. The probability of making at least one Type 1 error in a single 2x2x2 ANOVA is 1-(0.95)^7 = 30%.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b*2b*2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>) <span class="co">#All means are equal - so there is no real difference.</span>
<span class="co"># Enter means in the order that matches the labels below.</span>
sd &lt;-<span class="st"> </span><span class="dv">5</span>
p_adjust =<span class="st"> &quot;none&quot;</span>
<span class="co"># &quot;none&quot; means we do not correct for multiple comparisons</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;condition1&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;condition2&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;condition3&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>) <span class="co">#</span>
<span class="co"># the label names should be in the order of the means specified above.</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span>
<span class="co">#We set the alpha level at 0.05. </span>
power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                            <span class="dt">alpha_level =</span> alpha_level, 
                            <span class="dt">p_adjust =</span> p_adjust,
                            <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##                                        power effect_size
## anova_condition1                           2    0.002328
## anova_condition2                           6    0.002351
## anova_condition3                           6    0.002704
## anova_condition1:condition2                1    0.002053
## anova_condition1:condition3                6    0.002656
## anova_condition2:condition3                7    0.002552
## anova_condition1:condition2:condition3     8    0.002856
## 
## Power and Effect sizes for contrasts
##                                                                                 power
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_c_condition3_f     5
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_e     2
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_f     4
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_e     6
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f     5
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e     9
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f     6
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_e     3
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_f     8
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_e     2
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_f     5
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e     7
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f     6
## p_condition1_a_condition2_d_condition3_e_condition1_a_condition2_d_condition3_f     7
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_e     1
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_f     5
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_e     5
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f     3
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_e     7
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_f     7
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_e     7
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_f     5
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f     7
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e     7
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f     3
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e     5
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f     4
## p_condition1_b_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f     3
##                                                                                 effect_size
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_c_condition3_f  -0.0274899
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_e   0.0267475
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_f   0.0055897
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_e   0.0132975
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f   0.0122938
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e   0.0197361
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f   0.0195135
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_e   0.0552358
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_f   0.0316891
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_e   0.0401208
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_f   0.0386798
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e   0.0488620
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f   0.0494792
## p_condition1_a_condition2_d_condition3_e_condition1_a_condition2_d_condition3_f  -0.0238790
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_e  -0.0154989
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_f  -0.0168565
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_e  -0.0071455
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f  -0.0083037
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_e   0.0084359
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_f   0.0068890
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_e   0.0167493
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_f   0.0171173
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f   0.0001106
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e   0.0084590
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f   0.0093166
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e   0.0100318
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f   0.0105649
## p_condition1_b_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f  -0.0005965</code></pre>
<p>When there is no true effect, we formally do not have ‘power’ (which is defined as the probability of finding p &lt; <span class="math inline">\(\alpha\)</span> if there is a true effect to be found) so the power column should be read as the ‘Type 1 error rate’. Because we have saved the power simulation in the ‘power_result’ object, we can perform calculations on the ‘sim_data’ dataframe that is stored. This dataframe contains the results for the nsims simulations (e.g., 10000 rows if you ran 10000 simulations) and stores the p-values and effect size estimates for each ANOVA. The first 7 columns are the p-values for the ANOVA, first the main effects of condition 1, 2, and 3, then three two-way interactions, and finally the threeway interaction.</p>
<p>We can calculate the number of significant results for each test (which should be 5%) by counting the number of significant p-values in each of the 7 rows:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="kw">as.matrix</span>(power_result<span class="op">$</span>sim_data[(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)]), <span class="dv">2</span>, 
    <span class="cf">function</span>(x) <span class="kw">round</span>(<span class="kw">mean</span>(<span class="kw">ifelse</span>(x <span class="op">&lt;</span><span class="st"> </span>alpha_level, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),<span class="dv">4</span>))</code></pre>
<pre><code>##                       anova_condition1 
##                                      2 
##                       anova_condition2 
##                                      6 
##                       anova_condition3 
##                                      6 
##            anova_condition1:condition2 
##                                      1 
##            anova_condition1:condition3 
##                                      6 
##            anova_condition2:condition3 
##                                      7 
## anova_condition1:condition2:condition3 
##                                      8</code></pre>
<p>This is the Type 1 error rate for each test. When we talk about error rate inflation due to multiple comparisons, we are talking about the probability that you conclude there is an effect, when there is actually no effect, when there is a significant effect for the main effect of condition 1, or condition 2, or condition 3, or for the two-way interaction between condition 1 and 2, or condition 1 and 3, or condition 2 and 3, or in the threeway interaction.</p>
<p>To calculate this error rate we do not just add the 7 error rates (so 7 * 5% - 35%). Instead, we calculate the probability that there will be at least one significant result in an ANOVA we perform. Some ANOVA results will have multiple significant results, just due to the Type 1 error rate (e.g., a significant result for the threeway interaction, and for the main effect of condition 1) but such an ANOVA is counted only once. Iwe calculate this percentage from our simulations, we see the number is indeed very close to 1-(0.95)^7 = 30%.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">apply</span>(<span class="kw">as.matrix</span>(power_result<span class="op">$</span>sim_data[(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)]), <span class="dv">1</span>, 
    <span class="cf">function</span>(x) <span class="kw">round</span>(<span class="kw">mean</span>(<span class="kw">ifelse</span>(x <span class="op">&lt;</span><span class="st"> </span>alpha_level, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),<span class="dv">4</span>)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="op">/</span>nsims<span class="op">*</span><span class="dv">100</span></code></pre>
<pre><code>## [1] 34</code></pre>
<p>The question is what we should do about this alpha inflation. It is undesirable if you perform exploratory ANOVA’s and are fooled too often by Type 1 errors, which will not replicate if you try to build on them. Therefore, you need to control the Type 1 error rate.</p>
<p>In the simulation code, which relies on the afex package, there is the option to set p_adjust. In the simulation above, p_adjust was set to “none”. This means no adjustment is mage to which p-values are considered to be significant, and the alpha level is used as it is set in the simulation (above this was 0.05).</p>
<p>Afex relies on the p.adjust functon in the stats package in R (more information is available <a href="https://www.rdocumentation.org/packages/stats/versions/3.1.1/topics/p.adjust">here</a>). From the package details:</p>
<p><em>The adjustment methods include the Bonferroni correction (“bonferroni”) in which the p-values are multiplied by the number of comparisons. Less conservative corrections are also included by Holm (1979) (“holm”), Hochberg (1988) (“hochberg”), Hommel (1988) (“hommel”), Benjamini &amp; Hochberg (1995) (“BH” or its alias “fdr”), and Benjamini &amp; Yekutieli (2001) (“BY”), respectively. A pass-through option (“none”) is also included. The first four methods are designed to give strong control of the family-wise error rate. There seems no reason to use the unmodified Bonferroni correction because it is dominated by Holm’s method, which is also valid under arbitrary assumptions.</em></p>
<p><em>Hochberg’s and Hommel’s methods are valid when the hypothesis tests are independent or when they are non-negatively associated (Sarkar, 1998; Sarkar and Chang, 1997). Hommel’s method is more powerful than Hochberg’s, but the difference is usually small and the Hochberg p-values are faster to compute.</em></p>
<p><em>The “BH” (aka “fdr”) and “BY” method of Benjamini, Hochberg, and Yekutieli control the false discovery rate, the expected proportion of false discoveries amongst the rejected hypotheses. The false discovery rate is a less stringent condition than the family-wise error rate, so these methods are more powerful than the others.</em></p>
<p>Let’s re-run the simulation twith the Holm-Bonferroni correction, which is simple and require no assumptions.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b*2b*2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>) <span class="co">#All means are equal - so there is no real difference.</span>
<span class="co"># Enter means in the order that matches the labels below.</span>
sd &lt;-<span class="st"> </span><span class="dv">5</span>
p_adjust =<span class="st"> &quot;holm&quot;</span>
<span class="co"># Changed to Holm-Bonferroni</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;condition1&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;condition2&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;condition3&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>) <span class="co">#</span>
<span class="co"># the label names should be in the order of the means specified above.</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">alpha_level &lt;-<span class="st"> </span><span class="fl">0.05</span>
<span class="co">#We set the alpha level at 0.05. </span>
power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, 
                            <span class="dt">alpha_level =</span> alpha_level,
                            <span class="dt">p_adjust =</span> p_adjust,
                            <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##                                        power effect_size
## anova_condition1                           0    0.002667
## anova_condition2                           1    0.002505
## anova_condition3                           0    0.002728
## anova_condition1:condition2                2    0.002525
## anova_condition1:condition3                1    0.001754
## anova_condition2:condition3                1    0.002809
## anova_condition1:condition2:condition3     0    0.002426
## 
## Power and Effect sizes for contrasts
##                                                                                 power
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_c_condition3_f     1
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_e     0
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_f     0
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_e     0
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f     0
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e     0
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f     0
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_e     0
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_f     0
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_e     0
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_f     0
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e     1
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f     0
## p_condition1_a_condition2_d_condition3_e_condition1_a_condition2_d_condition3_f     0
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_e     0
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_f     0
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_e     0
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f     0
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_e     0
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_f     0
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_e     0
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_f     1
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f     0
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e     0
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f     1
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e     0
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f     0
## p_condition1_b_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f     0
##                                                                                 effect_size
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_c_condition3_f   0.0319656
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_e  -0.0019998
## p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_f   0.0291337
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_e  -0.0102247
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f   0.0249407
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e   0.0012879
## p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f  -0.0050040
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_e  -0.0332806
## p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_f   0.0007697
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_e  -0.0436373
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_f  -0.0071652
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e  -0.0293800
## p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f  -0.0375714
## p_condition1_a_condition2_d_condition3_e_condition1_a_condition2_d_condition3_f   0.0340495
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_e  -0.0104663
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_f   0.0280520
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_e   0.0026967
## p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f  -0.0044352
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_e  -0.0431155
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_f  -0.0048866
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_e  -0.0296965
## p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_f  -0.0369559
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f   0.0408374
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e   0.0147371
## p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f   0.0074189
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e  -0.0212855
## p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f  -0.0310634
## p_condition1_b_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f  -0.0098486</code></pre>
<p>If we now calculate the overall Type 1 error rate:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">apply</span>(<span class="kw">as.matrix</span>(power_result<span class="op">$</span>sim_data[(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)]), <span class="dv">1</span>, 
    <span class="cf">function</span>(x) <span class="kw">round</span>(<span class="kw">mean</span>(<span class="kw">ifelse</span>(x <span class="op">&lt;</span><span class="st"> </span>alpha_level, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>),<span class="dv">4</span>)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="op">/</span>nsims<span class="op">*</span><span class="dv">100</span></code></pre>
<pre><code>## [1] 5</code></pre>
<p>We see it is close to 5%. Note that error rates have variation, and even in a few thousand simulations, the error rate in the sample of studies can easily be half a percentage point higher or lower. But <em>in the long run</em> the error rate should equal the alpha level. Furthermore, note that the <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-bonferroni</a> method is slightly more powerful than the Bonferroni procedure (which is simply <span class="math inline">\(\alpha\)</span> divided by the numner of tests). There are more powerful procedures to control the Type 1 error rate, which require more assumptions. For a small number of tests, they Holm-Bonferroni procedure works well. Alternative procedure to control error rates can be found in the <a href="https://cran.r-project.org/web/packages/multcomp/index.html">multcomp</a> R package.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="mixed-anova-part-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-in-interactions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
