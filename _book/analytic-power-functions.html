<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Analytic Power Functions | Validation of Superpower</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Analytic Power Functions | Validation of Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Analytic Power Functions | Validation of Superpower" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-for-interactions.html"/>
<link rel="next" href="power-curve.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#validation-of-power-in-one-way-anova-part-1"><i class="fa fa-check"></i><b>2.1</b> Validation of Power in One-Way ANOVA Part 1</a><ul>
<li class="chapter" data-level="2.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>2.1.1</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-2-brysbaert-example"><i class="fa fa-check"></i><b>2.2</b> One-way ANOVA Part 2: Brysbaert example</a><ul>
<li class="chapter" data-level="2.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Three conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>2.2.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-part-3"><i class="fa fa-check"></i><b>2.3</b> One-way ANOVA Part 3</a><ul>
<li class="chapter" data-level="2.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication"><i class="fa fa-check"></i><b>2.3.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-1"><i class="fa fa-check"></i><b>2.3.2</b> Variation 1</a></li>
<li class="chapter" data-level="2.3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>2.3.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="2.3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-2"><i class="fa fa-check"></i><b>2.3.4</b> Variation 2</a></li>
<li class="chapter" data-level="2.3.5" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>2.3.5</b> Three conditions replication</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>3</b> Repeated Measures-ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-2"><i class="fa fa-check"></i><b>3.2</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>3.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="3.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-3"><i class="fa fa-check"></i><b>3.3</b> Repeated Measures-ANOVA Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>3.4</b> Reproducing Brysbaert</a></li>
<li class="chapter" data-level="3.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>3.5</b> Reproducing Brysbaert Variation 1 Changing Correlation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>4</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="mixed-anova.html"><a href="mixed-anova.html#part-1-two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>4.1</b> Part 1: Two by two ANOVA, within-between design</a><ul>
<li class="chapter" data-level="4.1.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>4.1.1</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mixed-anova.html"><a href="mixed-anova.html#part-2-two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>4.2</b> Part 2: Two by two ANOVA, within-within design</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.2.1</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="mixed-anova.html"><a href="mixed-anova.html#part-3-two-by-two-anova-within-design"><i class="fa fa-check"></i><b>4.3</b> Part 3: Two by two ANOVA, within design</a></li>
<li class="chapter" data-level="4.4" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>4.4</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>5</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="6" data-path="power-for-interactions.html"><a href="power-for-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Interactions</a></li>
<li class="chapter" data-level="7" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>7</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>7.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>7.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="7.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>7.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="7.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>7.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>8</b> Power Curve</a></li>
<li class="chapter" data-level="9" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>9</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="9.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>9.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="9.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>9.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="9.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>9.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="11" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html"><i class="fa fa-check"></i><b>11</b> Power for Design Variations</a><ul>
<li class="chapter" data-level="11.1" data-path="power-for-design-variations.html"><a href="power-for-design-variations.html#within-designs"><i class="fa fa-check"></i><b>11.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="setting-the-correlation-matrix.html"><a href="setting-the-correlation-matrix.html"><i class="fa fa-check"></i><b>12</b> Setting the Correlation Matrix</a></li>
<li class="chapter" data-level="13" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html"><i class="fa fa-check"></i><b>13</b> Validation of Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="13.1" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>13.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="13.2" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>13.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="13.3" data-path="validation-of-effect-size-estimates-for-one-way-anova.html"><a href="validation-of-effect-size-estimates-for-one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>13.3</b> Two conditions, large effect size</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Validation of Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analytic-power-functions" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Analytic Power Functions</h1>
<p>For some designs it is possible to calculate power analytically, using closed functions.</p>
<div id="one-way-between-subject-anova" class="section level2">
<h2><span class="header-section-number">7.1</span> One-Way Between Subject ANOVA</h2>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1">string &lt;-<span class="st"> &quot;4b&quot;</span></a>
<a class="sourceLine" id="cb299-2" title="2">n &lt;-<span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb299-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">82</span>, <span class="dv">82</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb299-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb299-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb299-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb299-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb299-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb299-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb299-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb299-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb299-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb299-13" title="13">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> <span class="fl">0.05</span>, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                power effect_size
## anova_Factor_A    81     0.05614
## 
## Power and Effect sizes for contrasts
##                           power effect_size
## p_Factor_A_a1_Factor_A_a2    15    0.203527
## p_Factor_A_a1_Factor_A_a3    21    0.199665
## p_Factor_A_a1_Factor_A_a4    88    0.595944
## p_Factor_A_a2_Factor_A_a3     6   -0.004499
## p_Factor_A_a2_Factor_A_a4    60    0.395102
## p_Factor_A_a3_Factor_A_a4    60    0.399617</code></pre>
<p>We can also calculate power analytically with our own function.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power <span class="co">#using default alpha level of .05</span></a></code></pre></div>
<pre><code>## [1] 0.8121291</code></pre>
<p>This is a generalized function for One-Way ANOVA’s for any number of groups. It is in part based on code provided with the excellent book by Aberson (2019) Applied Power Analysis for the Behavioral Sciences (but Aberson’s code allows for different n per condition, and different sd per condition).</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1"><span class="kw">anova1f_4</span>(<span class="dt">m1 =</span> <span class="dv">80</span>, <span class="dt">m2 =</span> <span class="dv">82</span>, <span class="dt">m3 =</span> <span class="dv">82</span>, <span class="dt">m4 =</span> <span class="dv">86</span>,</a>
<a class="sourceLine" id="cb303-2" title="2">          <span class="dt">s1 =</span> <span class="dv">10</span>, <span class="dt">s2 =</span> <span class="dv">10</span>, <span class="dt">s3 =</span> <span class="dv">10</span>, <span class="dt">s4 =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb303-3" title="3">          <span class="dt">n1 =</span> <span class="dv">60</span>, <span class="dt">n2 =</span> <span class="dv">60</span>, <span class="dt">n3 =</span> <span class="dv">60</span>, <span class="dt">n4 =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb303-4" title="4">          <span class="dt">alpha =</span> <span class="fl">.05</span>)</a></code></pre></div>
<p>We can also use the function in the pwr package. Note that we need to calculate f to use this function, which is based on the means and sd, as illustrated in the formulas above.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1"><span class="kw">pwr.anova.test</span>(<span class="dt">n =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb304-2" title="2">               <span class="dt">k =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb304-3" title="3">               <span class="dt">f =</span> <span class="fl">0.2179449</span>,</a>
<a class="sourceLine" id="cb304-4" title="4">               <span class="dt">sig.level =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 4
##               n = 60
##               f = 0.2179449
##       sig.level = 0.05
##           power = 0.8121289
## 
## NOTE: n is number in each group</code></pre>
<p>Finally, G*Power provides the option to calculate f from the means, sd and n for the cells. It can then be used to calculate power.</p>
<p><img src="screenshots/gpower_13.png" /></p>
</div>
<div id="two-way-between-subject-interaction" class="section level2">
<h2><span class="header-section-number">7.2</span> Two-way Between Subject Interaction</h2>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">string &lt;-<span class="st"> &quot;2b*2b&quot;</span></a>
<a class="sourceLine" id="cb306-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb306-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) </a>
<a class="sourceLine" id="cb306-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb306-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb306-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb306-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb306-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb306-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb306-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb306-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb306-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb306-13" title="13">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> <span class="fl">0.05</span>, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power effect_size
## anova_A      59     0.07155
## anova_B      67     0.07350
## anova_A:B    57     0.05936
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_A_a1_B_b1_A_a1_B_b2     3    0.054060
## p_A_a1_B_b1_A_a2_B_b1     6    0.046515
## p_A_a1_B_b1_A_a2_B_b2    85    1.029677
## p_A_a1_B_b2_A_a2_B_b1     6   -0.006821
## p_A_a1_B_b2_A_a2_B_b2    87    0.973047
## p_A_a2_B_b1_A_a2_B_b2    85    0.974711</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##     power partial_eta_squared cohen_f non_centrality
## A   59.79              0.0617  0.2565              5
## B   59.79              0.0617  0.2565              5
## A:B 59.79              0.0617  0.2565              5
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_A_a1_B_b1_A_a1_B_b2   5.0           0
## p_A_a1_B_b1_A_a2_B_b1   5.0           0
## p_A_a1_B_b1_A_a2_B_b2  86.9           1
## p_A_a1_B_b2_A_a2_B_b1   5.0           0
## p_A_a1_B_b2_A_a2_B_b2  86.9           1
## p_A_a2_B_b1_A_a2_B_b2  86.9           1</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1">power_res &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result) <span class="co">#using default alpha level of .05</span></a>
<a class="sourceLine" id="cb310-2" title="2">power_res<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.5978655</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1">power_res<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.5978655</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">power_res<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.5978655</code></pre>
<p>We can use the function by Aberson, 2019, as well.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">anova2x2</span>(<span class="dt">m1.1=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-2" title="2">         <span class="dt">m1.2=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-3" title="3">         <span class="dt">m2.1=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-4" title="4">         <span class="dt">m2.2=</span><span class="dv">25</span>, </a>
<a class="sourceLine" id="cb316-5" title="5">         <span class="dt">s1.1=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb316-6" title="6">         <span class="dt">s1.2=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb316-7" title="7">         <span class="dt">s2.1=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb316-8" title="8">         <span class="dt">s2.2=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb316-9" title="9">         <span class="dt">n1.1=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-10" title="10">         <span class="dt">n1.2=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-11" title="11">         <span class="dt">n2.1=</span><span class="dv">20</span>,</a>
<a class="sourceLine" id="cb316-12" title="12">         <span class="dt">n2.2=</span><span class="dv">20</span>, </a>
<a class="sourceLine" id="cb316-13" title="13">         <span class="dt">alpha=</span>.<span class="dv">05</span>, </a>
<a class="sourceLine" id="cb316-14" title="14">         <span class="dt">all=</span><span class="st">&quot;OFF&quot;</span>)</a></code></pre></div>
</div>
<div id="x3-between-subject-anova" class="section level2">
<h2><span class="header-section-number">7.3</span> 3x3 Between Subject ANOVA</h2>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1">string &lt;-<span class="st"> &quot;3b*3b&quot;</span></a>
<a class="sourceLine" id="cb317-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb317-3" title="3">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></a>
<a class="sourceLine" id="cb317-4" title="4"><span class="co"># Enter means in the order that matches the labels below.</span></a>
<a class="sourceLine" id="cb317-5" title="5">sd &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb317-6" title="6">labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;Factor_B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>, <span class="st">&quot;b3&quot;</span>) <span class="co">#</span></a>
<a class="sourceLine" id="cb317-7" title="7"><span class="co"># the label names should be in the order of the means specified above.</span></a>
<a class="sourceLine" id="cb317-8" title="8">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb317-9" title="9">                   <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb317-10" title="10">                   <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb317-11" title="11">                   <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb317-12" title="12">                   <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb317-13" title="13">power_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> <span class="fl">0.05</span>, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                         power effect_size
## anova_Factor_A             38     0.03305
## anova_Factor_B             46     0.03341
## anova_Factor_A:Factor_B    67     0.07225
## 
## Power and Effect sizes for contrasts
##                                                   power effect_size
## p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b2     9  -0.0030588
## p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b3     5  -0.0087725
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b1     5   0.0069512
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b2     8   0.0298433
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b3     3   0.0061782
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b1    12  -0.0186493
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b2     6  -0.0030377
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b3    86   1.0018813
## p_Factor_A_a1_Factor_B_b2_Factor_A_a1_Factor_B_b3     9  -0.0056309
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b1     3   0.0088757
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b2     6   0.0363153
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b3     2   0.0057980
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b1     5  -0.0075501
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b2     5   0.0065571
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b3    89   1.0201301
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b1     6   0.0142075
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b2     4   0.0400306
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b3     4   0.0074802
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b1     4  -0.0123774
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b2     2   0.0043240
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b3    87   1.0181551
## p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b2     4   0.0233285
## p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b3     5  -0.0005765
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b1     8  -0.0217793
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b2     4  -0.0051040
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b3    84   1.0024276
## p_Factor_A_a2_Factor_B_b2_Factor_A_a2_Factor_B_b3     4  -0.0301280
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b1     6  -0.0488191
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b2     4  -0.0310566
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b3    86   0.9876450
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b1     8  -0.0145987
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b2     3  -0.0033945
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b3    87   0.9899162
## p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b2     8   0.0143525
## p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b3    92   1.0505793
## p_Factor_A_a3_Factor_B_b2_Factor_A_a3_Factor_B_b3    88   1.0179745</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                   power partial_eta_squared cohen_f non_centrality
## Factor_A          44.86              0.0253  0.1612         4.4444
## Factor_B          44.86              0.0253  0.1612         4.4444
## Factor_A:Factor_B 64.34              0.0494  0.2280         8.8889
## 
## Power and Effect sizes for contrasts
##                                                   power effect_size
## p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a1_Factor_B_b3   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a2_Factor_B_b3   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a1_Factor_B_b2_Factor_A_a1_Factor_B_b3   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a2_Factor_B_b3   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b3_Factor_A_a2_Factor_B_b3   5.0           0
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a1_Factor_B_b3_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b2   5.0           0
## p_Factor_A_a2_Factor_B_b1_Factor_A_a2_Factor_B_b3   5.0           0
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a2_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a2_Factor_B_b2_Factor_A_a2_Factor_B_b3   5.0           0
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a2_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b1   5.0           0
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a2_Factor_B_b3_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b2   5.0           0
## p_Factor_A_a3_Factor_B_b1_Factor_A_a3_Factor_B_b3  86.9           1
## p_Factor_A_a3_Factor_B_b2_Factor_A_a3_Factor_B_b3  86.9           1</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1">power_res &lt;-<span class="st"> </span><span class="kw">power_twoway_between</span>(design_result) <span class="co">#using default alpha level of .05</span></a>
<a class="sourceLine" id="cb321-2" title="2">power_res<span class="op">$</span>power_A</a></code></pre></div>
<pre><code>## [1] 0.4486306</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1">power_res<span class="op">$</span>power_B</a></code></pre></div>
<pre><code>## [1] 0.4486306</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">power_res<span class="op">$</span>power_AB</a></code></pre></div>
<pre><code>## [1] 0.6434127</code></pre>
</div>
<div id="two-by-two-anova-within-design" class="section level2">
<h2><span class="header-section-number">7.4</span> Two by two ANOVA, within design</h2>
<p>Potvin &amp; Schutz (2000) simulate a wide range of repeated measure designs. The give an example of a 3x3 design, with the following correlation matrix:</p>
<p><img src="screenshots/PS2000.png" /></p>
<p>Variances were set to 1 (so all covariance matrices in their simulations were identical). In this specific example, the white fields are related to the correlation for the A main effect (these cells have the same level for B, but different levels of A). The grey cells are related to the main effect of B (the cells have the same level of A, but different levels of B). Finally, the black cells are related to the AxB interaction (they have different levels of A and B). The diagonal (all 1) relate to cells with the same levels of A and B.</p>
<p>Potvin &amp; Schulz (2000) examine power for 2x2 within ANOVA designs and develop approximations of the error variance. For a design with 2 within factors (A and B) these are:</p>
<p>For the main effect of A:
<span class="math inline">\(\sigma _ { e } ^ { 2 } = \sigma ^ { 2 } ( 1 - \overline { \rho } _ { A } ) + \sigma ^ { 2 } ( q - 1 ) ( \overline { \rho } _ { B } - \overline { \rho } _ { AB } )\)</span></p>
<p>For the main effectof B:
<span class="math inline">\(\sigma _ { e } ^ { 2 } = \sigma ^ { 2 } ( 1 - \overline { \rho } _ { B } ) + \sigma ^ { 2 } ( p - 1 ) ( \overline { \rho } _ { A } - \overline { \rho } _ { A B } )\)</span></p>
<p>For the interaction between A and B:
<span class="math inline">\(\sigma _ { e } ^ { 2 } = \sigma ^ { 2 } ( 1 - \rho _ { \max } ) - \sigma ^ { 2 } ( \overline { \rho } _ { \min } - \overline { \rho } _ { AB } )\)</span></p>
<p>We first simulate a within subjects 2x2 ANOVA design.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1">mu =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb327-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb327-3" title="3">sd &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb327-4" title="4">r &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb327-5" title="5">  <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb327-6" title="6">       <span class="fl">0.4</span>, <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb327-7" title="7">            <span class="fl">0.8</span></a>
<a class="sourceLine" id="cb327-8" title="8">  )</a>
<a class="sourceLine" id="cb327-9" title="9">string =<span class="st"> &quot;2w*2w&quot;</span></a>
<a class="sourceLine" id="cb327-10" title="10">labelnames =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>)</a>
<a class="sourceLine" id="cb327-11" title="11">design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,</a>
<a class="sourceLine" id="cb327-12" title="12">                              <span class="dt">n =</span> n, </a>
<a class="sourceLine" id="cb327-13" title="13">                              <span class="dt">mu =</span> mu, </a>
<a class="sourceLine" id="cb327-14" title="14">                              <span class="dt">sd =</span> sd, </a>
<a class="sourceLine" id="cb327-15" title="15">                              <span class="dt">r =</span> r, </a>
<a class="sourceLine" id="cb327-16" title="16">                              <span class="dt">labelnames =</span> labelnames)</a>
<a class="sourceLine" id="cb327-17" title="17">simulation_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">alpha_level =</span> <span class="fl">0.05</span>, <span class="dt">nsims =</span> nsims)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power effect_size
## anova_A      28      0.1222
## anova_B      63      0.2395
## anova_A:B    24      0.1324
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_A_a1_B_b1_A_a1_B_b2    19   -0.288441
## p_A_a1_B_b1_A_a2_B_b1    38    0.410534
## p_A_a1_B_b1_A_a2_B_b2     3    0.005137
## p_A_a1_B_b2_A_a2_B_b1    61    0.553586
## p_A_a1_B_b2_A_a2_B_b2    12    0.193299
## p_A_a2_B_b1_A_a2_B_b2    80   -0.653693
## 
## Within-Subject Factors Included: Check MANOVA Results</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result, <span class="dt">alpha_level =</span> alpha_level)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##     power partial_eta_squared cohen_f non_centrality
## A   26.92              0.0952  0.3244              2
## B   64.23              0.2400  0.5620              6
## A:B 26.92              0.0952  0.3244              2
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_A_a1_B_b1_A_a1_B_b2 26.92     -0.3162
## p_A_a1_B_b1_A_a2_B_b1 39.70      0.4000
## p_A_a1_B_b1_A_a2_B_b2  5.00      0.0000
## p_A_a1_B_b2_A_a2_B_b1 64.23      0.5477
## p_A_a1_B_b2_A_a2_B_b2 13.60      0.2000
## p_A_a2_B_b1_A_a2_B_b2 76.52     -0.6325</code></pre>
<p>We can use the <code>ANOVA_exact</code> function to evaluate this design since there is not a analytic solution in <code>Superpower</code>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" title="1">power_res &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(<span class="dt">design_result =</span> design_result)</a></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##     power partial_eta_squared cohen_f non_centrality
## A   26.92              0.0952  0.3244              2
## B   64.23              0.2400  0.5620              6
## A:B 26.92              0.0952  0.3244              2
## 
## Power and Effect sizes for contrasts
##                       power effect_size
## p_A_a1_B_b1_A_a1_B_b2 26.92     -0.3162
## p_A_a1_B_b1_A_a2_B_b1 39.70      0.4000
## p_A_a1_B_b1_A_a2_B_b2  5.00      0.0000
## p_A_a1_B_b2_A_a2_B_b1 64.23      0.5477
## p_A_a1_B_b2_A_a2_B_b2 13.60      0.2000
## p_A_a2_B_b1_A_a2_B_b2 76.52     -0.6325</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" title="1">power_res<span class="op">$</span>main_results</a></code></pre></div>
<pre><code>##     power partial_eta_squared cohen_f non_centrality
## A   26.92              0.0952  0.3244              2
## B   64.23              0.2400  0.5620              6
## A:B 26.92              0.0952  0.3244              2</code></pre>
<p>We can use <code>pwr2ppl</code> by Aberson (2019) to produce the same results.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" title="1"><span class="kw">win2F</span>(</a>
<a class="sourceLine" id="cb335-2" title="2">  <span class="dt">m1.1 =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb335-3" title="3">  <span class="dt">m2.1 =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb335-4" title="4">  <span class="dt">m1.2 =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb335-5" title="5">  <span class="dt">m2.2 =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb335-6" title="6">  <span class="dt">s1.1 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb335-7" title="7">  <span class="dt">s2.1 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb335-8" title="8">  <span class="dt">s1.2 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb335-9" title="9">  <span class="dt">s2.2 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb335-10" title="10">  <span class="dt">r12 =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb335-11" title="11">  <span class="dt">r13 =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb335-12" title="12">  <span class="dt">r14 =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb335-13" title="13">  <span class="dt">r23 =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb335-14" title="14">  <span class="dt">r24 =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb335-15" title="15">  <span class="dt">r34 =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb335-16" title="16">  <span class="dt">n =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb335-17" title="17">)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-for-interactions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-curve.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
