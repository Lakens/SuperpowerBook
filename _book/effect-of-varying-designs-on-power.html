<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Effect of Varying Designs on Power | The Superpower R Package: Capabilities and Validation</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Effect of Varying Designs on Power | The Superpower R Package: Capabilities and Validation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Effect of Varying Designs on Power | The Superpower R Package: Capabilities and Validation" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron Caldwell &amp; Daniël Lakens" />


<meta name="date" content="2019-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-for-interactions.html">
<link rel="next" href="error-control-in-exploratory-anova.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Superpower</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design</a><ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#correlation-matrix"><i class="fa fa-check"></i><b>2.1</b> Correlation Matrix</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#part-2"><i class="fa fa-check"></i><b>3.2</b> Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.2.2</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#part-3"><i class="fa fa-check"></i><b>3.3</b> Part 3</a><ul>
<li class="chapter" data-level="3.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication"><i class="fa fa-check"></i><b>3.3.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-1"><i class="fa fa-check"></i><b>3.3.2</b> Variation 1</a></li>
<li class="chapter" data-level="3.3.3" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>3.3.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="3.3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#variation-2"><i class="fa fa-check"></i><b>3.3.4</b> Variation 2</a></li>
<li class="chapter" data-level="3.3.5" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>3.3.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.4</b> Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.4.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="3.4.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.4.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="3.4.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.4.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures-ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1-1"><i class="fa fa-check"></i><b>4.1</b> Part 1</a><ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#repeated-measures-anova-part-2"><i class="fa fa-check"></i><b>4.2</b> Repeated Measures-ANOVA Part 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3-1"><i class="fa fa-check"></i><b>4.3</b> Part 3</a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert"><i class="fa fa-check"></i><b>4.4</b> Reproducing Brysbaert</a><ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#results"><i class="fa fa-check"></i><b>4.4.1</b> Results</a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#part-1-2"><i class="fa fa-check"></i><b>5.1</b> Part 1</a><ul>
<li class="chapter" data-level="5.1.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design"><i class="fa fa-check"></i><b>5.1.1</b> Two by two ANOVA, within-between design</a></li>
<li class="chapter" data-level="5.1.2" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-between-design-variation-1"><i class="fa fa-check"></i><b>5.1.2</b> Two by two ANOVA, within-between design Variation 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#part-2-1"><i class="fa fa-check"></i><b>5.2</b> Part 2</a><ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#two-by-two-anova-within-within-design"><i class="fa fa-check"></i><b>5.2.1</b> Two by two ANOVA, within-within design</a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>5.2.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mixed-anova.html"><a href="mixed-anova.html#part-3-2"><i class="fa fa-check"></i><b>5.3</b> Part 3</a></li>
<li class="chapter" data-level="5.4" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-example-2x2-within-design"><i class="fa fa-check"></i><b>5.4</b> Simple example: 2x2 within design</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analytic-power-for-three-way-interactions.html"><a href="analytic-power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Analytic Power for Three-way Interactions</a></li>
<li class="chapter" data-level="7" data-path="power-for-interactions.html"><a href="power-for-interactions.html"><i class="fa fa-check"></i><b>7</b> Power for Interactions</a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power</a><ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subject-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subject ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA</a></li>
<li class="chapter" data-level="10.4" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-by-two-anova-within-design"><i class="fa fa-check"></i><b>10.4</b> Two by two ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve</a></li>
<li class="chapter" data-level="12" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html"><i class="fa fa-check"></i><b>12</b> Explore increase in effect size for moderated interactions.</a><ul>
<li class="chapter" data-level="12.1" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>12.1</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="12.2" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>12.2</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="12.3" data-path="explore-increase-in-effect-size-for-moderated-interactions-.html"><a href="explore-increase-in-effect-size-for-moderated-interactions-.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>12.3</b> Increasing correlation in on factor decreases power in second factor</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Superpower R Package: Capabilities and Validation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="effect-of-varying-designs-on-power" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Effect of Varying Designs on Power</h1>
<p>Researchers might consider what the effects on the statistical power of their design is, when they add participants. Participants can be added to an additional condition, or to the existing design.</p>
<p>In a One-Way ANOVA adding a condition means, for example, going from a 1x2 to a 1x3 design. For example, in addition to a control and intensive training condition, we add a light training condition.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;intensive_training&quot;</span>) 
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(<span class="dt">design =</span> string,
                   <span class="dt">n =</span> n, 
                   <span class="dt">mu =</span> mu, 
                   <span class="dt">sd =</span> sd, 
                   <span class="dt">labelnames =</span> labelnames)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/variations_in_design-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power for the given N in the design_result</span>
<span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.8438754</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.08256881</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sim_result &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(design_result, <span class="dt">nsims =</span> nsims)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##                 power effect_size
## anova_Condition 84.64      0.0917
## 
## Power and Effect sizes for contrasts
##                                                  power effect_size
## p_Condition_control_Condition_intensive_training 84.64      0.6065</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power partial_eta_squared cohen_f non_centrality
## Condition 84.39              0.0841   0.303              9
## 
## Power and Effect sizes for contrasts
##                                                  power effect_size
## p_Condition_control_Condition_intensive_training 84.39         0.6</code></pre>
<p>We now addd a condition. Let’s assume the ‘light training’ condition falls in between the other two means.</p>
<p>And we can see power across sample sizes</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot power curve (from 5 to 100)</span>
<span class="kw">plot_power</span>(design_result, <span class="dt">max_n =</span> <span class="dv">100</span>)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;3b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">83</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-
<span class="kw">c</span>(<span class="st">&quot;Condition&quot;</span>,
<span class="st">&quot;control&quot;</span>,
<span class="st">&quot;light_training&quot;</span>,
<span class="st">&quot;intensive_training&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power for the given N in the design_result</span>
<span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7616545</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.244949</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.05660377</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power partial_eta_squared cohen_f non_centrality
## Condition 76.17              0.0577  0.2474              9
## 
## Power and Effect sizes for contrasts
##                                                         power effect_size
## p_Condition_control_Condition_light_training            31.78         0.3
## p_Condition_control_Condition_intensive_training        84.39         0.6
## p_Condition_light_training_Condition_intensive_training 31.78         0.3</code></pre>
<p>We see that adding a condition that falls between the other two means reduces our power. Let’s instead assume that the ‘light training’ condition is not different from the control condition. In other words, the mean we add is as extreme as one of the existing means.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot power curve (from 5 to 100)</span>
<span class="kw">plot_power</span>(design_result, <span class="dt">max_n =</span> <span class="dv">100</span>)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;3b&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-
<span class="kw">c</span>(<span class="st">&quot;Condition&quot;</span>,
<span class="st">&quot;control&quot;</span>,
<span class="st">&quot;light_training&quot;</span>,
<span class="st">&quot;intensive_training&quot;</span>)
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power for the given N in the design_result</span>
<span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.8762941</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.2828427</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_between</span>(design_result)<span class="op">$</span>eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.07407407</code></pre>
<p>Now power has increased. This is not always true. The power is a function of many factors in the design, incuding the effect size (Cohen’s f) and the total sample size (and the degrees of freedom and number of groups). But as we will see below, as we keep adding conditions, the power will reduce, even if initially, the power might increase.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot power curve (from 5 to 100)</span>
<span class="kw">plot_power</span>(design_result,<span class="dt">max_n =</span> <span class="dv">100</span>)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>It helps to think of these different designs in terms of either partial eta-squared, or Cohen’s f (the one can easily be converted into the other).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Two groups</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">86</span>)
sd =<span class="st"> </span><span class="dv">10</span>
n &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#sample size per condition</span>
mean_mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(mu,
<span class="dt">nrow =</span> <span class="dv">2</span>,
<span class="dt">ncol =</span> <span class="dv">1</span>)) <span class="co">#Create a mean matrix</span>
<span class="co"># Using the sweep function to remove rowmeans from the matrix</span>
mean_mat_res &lt;-<span class="st"> </span><span class="kw">sweep</span>(mean_mat, <span class="dv">2</span>, <span class="kw">rowMeans</span>(mean_mat))
mean_mat_res</code></pre>
<pre><code>##      [,1] [,2]
## [1,]   -3    3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_a &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
MS_a</code></pre>
<pre><code>## [1] 900</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_A &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
SS_A</code></pre>
<pre><code>## [1] 900</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_error &lt;-<span class="st"> </span>sd <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
MS_error</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_error &lt;-<span class="st"> </span>MS_error <span class="op">*</span><span class="st"> </span>(n <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)
SS_error</code></pre>
<pre><code>## [1] 10000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eta_p_<span class="dv">2</span> &lt;-<span class="st"> </span>SS_A <span class="op">/</span><span class="st"> </span>(SS_A <span class="op">+</span><span class="st"> </span>SS_error)
eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.08256881</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">f_<span class="dv">2</span> &lt;-<span class="st"> </span>eta_p_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>eta_p_<span class="dv">2</span>)
f_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.09</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Cohen_f &lt;-<span class="st"> </span><span class="kw">sqrt</span>(f_<span class="dv">2</span>)
Cohen_f</code></pre>
<pre><code>## [1] 0.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Three groups</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">83</span>, <span class="dv">86</span>)
sd =<span class="st"> </span><span class="dv">10</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mean_mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(mu,
<span class="dt">nrow =</span> <span class="dv">3</span>,
<span class="dt">ncol =</span> <span class="dv">1</span>)) <span class="co">#Create a mean matrix</span>
<span class="co"># Using the sweep function to remove rowmeans from the matrix</span>
mean_mat_res &lt;-<span class="st"> </span><span class="kw">sweep</span>(mean_mat, <span class="dv">2</span>, <span class="kw">rowMeans</span>(mean_mat))
mean_mat_res</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -3    0    3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_a &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
MS_a</code></pre>
<pre><code>## [1] 450</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_A &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
SS_A</code></pre>
<pre><code>## [1] 900</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_error &lt;-<span class="st"> </span>sd <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
MS_error</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_error &lt;-<span class="st"> </span>MS_error <span class="op">*</span><span class="st"> </span>(n <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)
SS_error</code></pre>
<pre><code>## [1] 15000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eta_p_<span class="dv">2</span> &lt;-<span class="st"> </span>SS_A <span class="op">/</span><span class="st"> </span>(SS_A <span class="op">+</span><span class="st"> </span>SS_error)
eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.05660377</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">f_<span class="dv">2</span> &lt;-<span class="st"> </span>eta_p_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>eta_p_<span class="dv">2</span>)
f_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.06</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Cohen_f &lt;-<span class="st"> </span><span class="kw">sqrt</span>(f_<span class="dv">2</span>)
Cohen_f</code></pre>
<pre><code>## [1] 0.244949</code></pre>
<p>The SS_A or the sum of squares for the main effect, is 900 for two groups, and the SS_error for the error term is 10000. When we add a group, SS_A is 900, and the SS_error is 15000. Because the added condition falls exactly on the grand mean (83), the sum of squared for this extra group is 0. In other words, it does nothing to increase the signal that there is a difference between groups. However, the sum of squares for the error, which is a function of the total sample size, is increased, which reduces the effect size. So, adding a condition that falls on the grand mean reduces the power for the main effect of the ANOVA. Obviously, adding such a group has other benefits, such as being able to compare the two means to a new third condition.</p>
<p>We already saw that adding a condition that has a mean as extreme as one of the existing groups also reduces the power. Let’s again do the calculations step by step when the extra group has a mean as extreme as one of the two original conditions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Three groups</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">86</span>)
sd =<span class="st"> </span><span class="dv">10</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mean_mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">matrix</span>(mu,
<span class="dt">nrow =</span> <span class="dv">3</span>,
<span class="dt">ncol =</span> <span class="dv">1</span>)) <span class="co">#Create a mean matrix</span>
<span class="co"># Using the sweep function to remove rowmeans from the matrix</span>
mean_mat_res &lt;-<span class="st"> </span><span class="kw">sweep</span>(mean_mat, <span class="dv">2</span>, <span class="kw">rowMeans</span>(mean_mat))
mean_mat_res</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -2   -2    4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_a &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
MS_a</code></pre>
<pre><code>## [1] 600</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_A &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(mean_mat_res <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
SS_A</code></pre>
<pre><code>## [1] 1200</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">MS_error &lt;-<span class="st"> </span>sd <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
MS_error</code></pre>
<pre><code>## [1] 100</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">SS_error &lt;-<span class="st"> </span>MS_error <span class="op">*</span><span class="st"> </span>(n <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)
SS_error</code></pre>
<pre><code>## [1] 15000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eta_p_<span class="dv">2</span> &lt;-<span class="st"> </span>SS_A <span class="op">/</span><span class="st"> </span>(SS_A <span class="op">+</span><span class="st"> </span>SS_error)
eta_p_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.07407407</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">f_<span class="dv">2</span> &lt;-<span class="st"> </span>eta_p_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>eta_p_<span class="dv">2</span>)
f_<span class="dv">2</span></code></pre>
<pre><code>## [1] 0.08</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Cohen_f &lt;-<span class="st"> </span><span class="kw">sqrt</span>(f_<span class="dv">2</span>)
Cohen_f</code></pre>
<pre><code>## [1] 0.2828427</code></pre>
<p>We see the sum of squares of the error stays the same - 15000 - because it is only determined by the standard error and the sample size, but not by the differences in the means. This is an increase of 5000 compared to the 2 group design. The sum of squares (the second component that determines the size of partial eta-squared) increases, which increases Cohen’s f. </p>
<div id="within-designs" class="section level2">
<h2><span class="header-section-number">8.1</span> Within Designs</h2>
<p>Now imagine our design described above was a within design. The means and sd remain the same. We collect 50 participants (instead of 100, or 50 per group, for the between design). Let’s first assume the two samples are completely uncorrelated.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;2w&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;intensive_training&quot;</span>) <span class="co">#</span>
design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.8366436</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power partial_eta_squared cohen_f non_centrality
## Condition 83.66              0.1552  0.4286              9
## 
## Power and Effect sizes for contrasts
##                                                  power effect_size
## p_Condition_control_Condition_intensive_training 84.39         0.6</code></pre>
<p>We see power is ever so slightly less than for the between subject design. This is due to the loss in degrees of freedom, which is 2(n-1) for between designs, and n-1 for within designs. But as the correlation increases, the power advantage of within designs becomes stronger.</p>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;3w&quot;</span>
n &lt;-<span class="st"> </span><span class="dv">50</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">83</span>, <span class="dv">86</span>) <span class="co">#All means are equal - so there is no real difference.</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
labelnames &lt;-
<span class="kw">c</span>(<span class="st">&quot;Condition&quot;</span>,
<span class="st">&quot;control&quot;</span>,
<span class="st">&quot;light_training&quot;</span>,
<span class="st">&quot;intensive_training&quot;</span>) <span class="co">#</span>

design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7570841</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(design_result)</code></pre>
<pre><code>## Power and Effect sizes for ANOVA tests
##           power partial_eta_squared cohen_f non_centrality
## Condition 75.71              0.0841   0.303              9
## 
## Power and Effect sizes for contrasts
##                                                         power effect_size
## p_Condition_control_Condition_light_training            31.78         0.3
## p_Condition_control_Condition_intensive_training        84.39         0.6
## p_Condition_light_training_Condition_intensive_training 31.78         0.3</code></pre>
<p>When we add a a condition in a within design where we expect the mean to be identical to the grand mean, we again see that the power decreases. This similarly shows that adding a condition that equals the grand mean to a within subject design does not come for free, but has a power cost.</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">30</span>
sd &lt;-<span class="st"> </span><span class="dv">10</span>
r &lt;-<span class="st"> </span><span class="fl">0.5</span>
string &lt;-<span class="st"> &quot;2w&quot;</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>) <span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>) <span class="co">#</span>
design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7539647</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.5085476</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 7.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 4.182964</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;3w&quot;</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>) <span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>) 

design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7937037</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.2357023</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.4152274</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 3.155932</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;4w&quot;</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>) <span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>) <span class="co">#</span>
design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-3.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7940126</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.2165064</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.3595975</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 11.25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 2.709402</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;5w&quot;</span>
mu &lt;-
<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>) 
<span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;a5&quot;</span>) 

design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-4.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7838682</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.3216338</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 12</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 2.44988</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;6w&quot;</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>) 
<span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;a5&quot;</span>, <span class="st">&quot;a6&quot;</span>) <span class="co">#</span>
design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-5.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.7699592</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.186339</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.2936101</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 12.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 2.276603</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">string &lt;-<span class="st"> &quot;7w&quot;</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>) 
<span class="co">#All means are equal - so there is no real difference.</span>
labelnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Factor_A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>,
                <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;a5&quot;</span>, <span class="st">&quot;a6&quot;</span>, <span class="st">&quot;a7&quot;</span>) 
design_result &lt;-
<span class="kw">ANOVA_design</span>(
<span class="dt">design =</span> string,
<span class="dt">n =</span> n,
<span class="dt">mu =</span> mu,
<span class="dt">sd =</span> sd,
<span class="dt">r =</span> r,
<span class="dt">labelnames =</span> labelnames
)</code></pre>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-99-6.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.754601</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f</code></pre>
<pre><code>## [1] 0.1749636</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>Cohen_f_SPSS</code></pre>
<pre><code>## [1] 0.2718301</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>lambda</code></pre>
<pre><code>## [1] 12.85714</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">power_oneway_within</span>(design_result)<span class="op">$</span>F_critical</code></pre>
<pre><code>## [1] 2.151016</code></pre>
<p>This set of designs where we increase the number of conditions demonstrates a common pattern where the power initially increases, but then starts to decrease. Again, the exact pattern (and when the power starts to decrease) depends on the effect size and sample size. Note also that the effect size (Cohen’s f) decreases as we add conditions, but the increased sample size compensates for this when calculating power. When using power analysis software such as GPower, this is important to realize. You can’t just power for a medium effect size, and then keep adding conditions under the assumption that the increased power you see in the program will become a reality. Increasing the number of conditions will reduce the effect size, and therefore, adding conditions will not automatically increase power (and might even decrease it).</p>
<p>Overall, the effect of adding conditions with an effect close to the grand mean reduces power quite strongly, and adding conditions with means close to the extreme of the current conditions will either slightly increase of decrease power.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-for-interactions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="error-control-in-exploratory-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
