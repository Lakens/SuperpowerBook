--- 
title: "The Superpower R Package: Capabilities and Validation"
author: "Aaron Caldwell & Dani&euml;l Lakens"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
description: "This is a book describing the capabilities of the Superpower R package."
---

# Introduction

Placeholder



<!--chapter:end:index.Rmd-->


# The Experimental Design

Placeholder


## ANOVA_design function
### Specifying the design using 'design'
### Specifying the means using 'mu'
### Specifying label names
### Specifying the correlation 
### Specifying the sample size
### Specifying the standard deviation

<!--chapter:end:01-Design.Rmd-->


# One-way ANOVA 

Placeholder


## Part 1
### Two conditions
## Part 2
### Three conditions
### Power for simple effects
## Part 3
### Three conditions replication
### Variation 1
### Three conditions replication
### Variation 2
### Three conditions replication
## Effect Size Estimates for One-Way ANOVA
### Three conditions, small effect size
### Four conditions, medium effect size
### Two conditions, large effect size

<!--chapter:end:02-onewayANOVA.Rmd-->


# Repeated Measures-ANOVA 

Placeholder


## Part 1
### Two conditions, medium effect size
## Repeated Measures-ANOVA Part 2
### The relation between Cohen's f and Cohen's d
### Three within conditions, medium effect size
## Part 3
## Reproducing Brysbaert
### Results
### Reproducing Brysbaert Variation 1: Changing Correlation

<!--chapter:end:03-rmANOVA.Rmd-->


# Mixed ANOVA 

Placeholder


## Part 1
### Two by two ANOVA, within-between design
### Two by two ANOVA, within-between design Variation 1
## Part 2
### Two by two ANOVA, within-within design
### Examine variation of means and correlation
## Part 3
## Simple example: 2x2 within design

<!--chapter:end:04-mixedANOVA.Rmd-->


# Analytic Power for Three-way Interactions

Placeholder



<!--chapter:end:05-ThreeWayInteraction.Rmd-->


# Power for Interactions

Placeholder



<!--chapter:end:06-NoWayInteraction.Rmd-->


# Effect of Varying Designs on Power

Placeholder


## Within Designs

<!--chapter:end:07-VariationsinDesign.Rmd-->


# Error Control in Exploratory ANOVA

Placeholder



<!--chapter:end:08-ErrorControlExploratoryANOVA.Rmd-->


# Analytic Power Functions

Placeholder


## One-Way Between Subject ANOVA
## Two-way Between Subject Interaction
## 3x3 Between Subject ANOVA
## Two by two ANOVA, within design

<!--chapter:end:09-AnalyticPowerFunctions.Rmd-->


# Power Curve

Placeholder


## Explore increase in effect size for cross-over interactions.
## Explore increase in correlation in moderated interactions.
## Increasing correlation in on factor decreases power in second factor

<!--chapter:end:10-PowerCurves.Rmd-->

# Appendix 1: Direct Comparison to `pwr2ppl`

In this appendix we have included the performance of `Superpower` to the `pwr2ppl` package using Chris Aberson's examples in [*Applied Power Analysis for the Behavioral Sciences*](https://www.crcpress.com/Applied-Power-Analysis-for-the-Behavioral-Sciences-2nd-Edition/Aberson/p/book/9781138044593) (2nd edition).

## Examples from Chapter 5

### Example 5.1/5.2

In this example, Aberson proposes a study expecting an average "score" of 80, 82, 82, and 86 for the control and three treatment groups respectively. The common standard deviation is 10 and the sample size per cell is 60.

```{r aberson_appendix}

design_result <- ANOVA_design(design = "4b",
                              n = 60,
                              sd = 10,
                              mu = c(80, 82, 82, 86),
                              labelnames = c("DORM",
                              "Control",
                              "T1",
                              "T2",
                              "T3"),
                              plot = TRUE)

```

Now we calculate the analytical result from `Superpower`.

```{r}
analytical_result <- power_oneway_between(design_result)

analytical_result$power
```

The `ANOVA_exact` result.

```{r}
exact_result <- ANOVA_exact(design_result, verbose = FALSE)

exact_result$main_results
```


And these match `pwr2ppl`.

```{r}
pwr2ppl_result <- anova1f_4(m1 = 80, m2 = 82, m3 = 82, m4 = 86,
                            s1 = 10, s2 = 10, s3 = 10, s4 = 10,
                            n1 = 60, n2 = 60, n3 = 60, n4 = 60)


```

### Example 5.3

Now a 2 x 2 between-subject ANOVA.

```{r aberson_5.3}

design_result <- ANOVA_design(design = "2b*2b",
                              n = 100,
                              sd = 1.7,
                              mu = c(.85, .85, 
                                     0, .6),
                              plot = TRUE)

```

Now we calculate the analytical result from `Superpower`.

```{r}
analytical_result <- power_twoway_between(design_result)

analytical_result$power_A

analytical_result$power_B

analytical_result$power_AB
```

The `ANOVA_exact` result.

```{r}
exact_result <- ANOVA_exact(design_result, verbose = FALSE)

exact_result$main_results
```


And these match `pwr2ppl`. From Table 5.12.

```{r}
pwr2ppl_result <- anova2x2(m1.1 = 0.85, m1.2 = 0.85, m2.1 = 0.00, m2.2 = 0.60,
                           s1.1 = 1.7, s1.2 = 1.7, s2.1 = 1.7, s2.2 = 1.7,
                           n1.1 = 100, n1.2 = 100, n2.1 = 100, n2.2 = 100,
                           alpha = .05)


```

Now we can increase the sample size to 250 per cell

```{r aberson_5.3}

design_result <- ANOVA_design(design = "2b*2b",
                              n = 250,
                              sd = 1.7,
                              mu = c(.85, .85, 
                                     0, .6),
                              plot = TRUE)

```

Now we calculate the analytical result from `Superpower`.

```{r}
analytical_result <- power_twoway_between(design_result)

analytical_result$power_A

analytical_result$power_B

analytical_result$power_AB
```

The `ANOVA_exact` result.

```{r}
exact_result <- ANOVA_exact(design_result, verbose = FALSE)

exact_result$main_results
```


And these match `pwr2ppl`.

```{r}
pwr2ppl_result <- anova2x2(m1.1 = 0.85, m1.2 = 0.85, m2.1 = 0.00, m2.2 = 0.60,
                           s1.1 = 1.7, s1.2 = 1.7, s2.1 = 1.7, s2.2 = 1.7,
                           n1.1 = 250, n1.2 = 250, n2.1 = 250, n2.2 = 250,
                           alpha = .05)


```


## Examples from Chapter 6

Repeated measures ANOVAs

### Example from Table 6.2


```{r aberson_6.2}

design_result <- ANOVA_design(design = "4w",
                              n = 25,
                              sd = c(.4,.5,.6,.7),
                              mu = c(-.25, .00, .10, .15),
                              r = c(.50, 
                                    .30,
                                    .15, 
                                    .5,
                                    .30, 
                                    .50),
                              plot = TRUE)

design_result$cor_mat

```

There is no analytical result from `Superpower` when the correlations vary.

Now we prouce 3 `ANOVA_exact` results representing no sphericity correction, Greenhouse-Geisser, and Huynh-Feldt corrected.

```{r}
exact_result <- ANOVA_exact(design_result, verbose = FALSE)

exact_result$main_results

exact_result <- ANOVA_exact(design_result,
                            correction = "GG",
                            verbose = FALSE)

exact_result$main_results

exact_result <- ANOVA_exact(design_result,
                            correction = "HF",
                            verbose = FALSE)

exact_result$main_results
```


And these match `pwr2ppl`. From Table 5.12.

```{r}
pwr2ppl_result <- win1F(m1 = -.25, m2 = .00, m3 = .10, m4 = .15,
                        s1 = .4, s2 = .5, s3 = .6, s4 = .7,
                        r12 = .50, r13 = .30,
                        r14 = .15, r23 = .5,
                        r24 = .30, r34 = .50,
                        n = 25)


```

<!--chapter:end:11-AppendixAberson.Rmd-->

